<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Linux From Scratch 10.1 Notes [Alpha] | amir.</title>

<meta name="keywords" content="LFS" />
<meta name="description" content="My notes about how to Linux From Scratch (10.1 Stable)">
<meta name="author" content="amir.">
<link rel="canonical" href="https://amirvincent64.github.io/en/posts/notes-10.1-linux-from-scratch/" />
<link href="https://amirvincent64.github.io/assets/css/stylesheet.min.23ca66c33946ea0cee2c04d1168bf7a5e397fb03f9bcd6cc11a233ae8e51b097.css" integrity="sha256-I8pmwzlG6gzuLATRFov3peOX&#43;wP5vNbMEaIzro5RsJc=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://amirvincent64.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://amirvincent64.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://amirvincent64.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://amirvincent64.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://amirvincent64.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.74.3" />
<link rel="alternate" hreflang="en" href="https://amirvincent64.github.io/en/posts/notes-10.1-linux-from-scratch/" />



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-189496691-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-189496691-1');
</script>

<meta property="og:title" content="Linux From Scratch 10.1 Notes [Alpha]" />
<meta property="og:description" content="My notes about how to Linux From Scratch (10.1 Stable)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://amirvincent64.github.io/en/posts/notes-10.1-linux-from-scratch/" />
<meta property="og:image" content="https://amirvincent64.github.io/images/VirtualBox_LFS_01.png" /><meta property="article:published_time" content="2021-02-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-02-16T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://amirvincent64.github.io/images/VirtualBox_LFS_01.png" />
<meta name="twitter:title" content="Linux From Scratch 10.1 Notes [Alpha]"/>
<meta name="twitter:description" content="My notes about how to Linux From Scratch (10.1 Stable)"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Linux From Scratch 10.1 Notes [Alpha]",
  "name": "Linux From Scratch 10.1 Notes [Alpha]",
  "description": "My notes about how to Linux From Scratch (10.1 Stable)\n",
  "keywords": [
    "LFS"
  ],
  "articleBody": "My notes about how to Linux From Scratch (10.1 Stable)\nfor full doc:\nhttp://www.linuxfromscratch.org/lfs/read.html\nif video tutorial needed, here comes playlist made by Kernotex:\nhttps://youtube.com/playlist?list=PLyc5xVO2uDsAlIkKBIGauDQ6LejoQovyL\n there’s a meme:\nand here’s how i did:\n1. download virtualbox and install it https://www.virtualbox.org/wiki/Downloads\n if you don’t know how to install and use, google it :-)\n 2. create host(ubuntu) VM Download Ubuntu Server LiveCD: https://ubuntu.com/download/server\nManual server installation - Download Ubuntu Server LTS\nI use :\n32G .vdi image\nUEFI: ON\nchoose manual partition\nmy setup:\n/dev/sda1 512M vfat for /boot/efi\n/dev/sda2 488M ext4 for /boot/\n/dev/sda3 4G ext4 for ubuntu host\n/dev/sda4 26G ext4 for LFS root\n/dev/sda5 1G ext4 for LFS backup\nsecond booting select Ubuntu\nthen login\nand enter the password\n$ sudo apt full-upgrade\t#to update packages and upgrade packages to lastest ssh to virtualbox (optional but recommend, if still not installed)\n$ sudo apt install openssh $ systemctl start sshd\t#start server $ systemctl enable sshd\t#to start it when boot then go here to see how to configure VM network:\nhttps://dev.to/yassineselllami/how-to-ssh-into-ubuntu-vm-virtualbox-from-host-machine-1kii\n3. configure host to check the requires:\n$ curl -sL https://github.com/viktomas/linux-from-scratch/raw/master/version-check.sh | bash sudo su - ln -svf /usr/bin/bash /bin/sh For LFS 10.1 install require packages:\nsudo apt install binutils bison gawk gcc g++ make texinfo build-essential sudo su - Set $LFS:\n$# export LFS=/mnt/lfs  $# echo $LFS\t#to check export  $# mkdir -pv $LFS\t#make $LFS folder $# mount -v -t ext4 /dev/sda4 $LFS\t#mount sda4 to $LFS $# mkdir -pv /mnt/lfsbackup\t#make /mnt/lfsbackup folder $# mount -v -t ext4 /dev/sda5 /mnt/lfsbackup\t#mount sda5 to /mnt/lfsbackup  to prevent unmount when reboot, halt; add your LFS partition to /etc/fstab, for example:\nadd\n/dev/\t/mnt/lfs ext4\tdefaults\t1\t1  $# mkdir -v $LFS/sources\t#make folder for sources $# chmod -v a+wt $LFS/sources\t#to add write permission and sticky mark Download needed source packages and patches 1 First install wget if not installed:\nsudo apt install wget There are several ways to optain all the necessary packages and patches to build LFS:\n  The files can be downloaded individually as described in the next two sections.\n  For stable versions of the book, a tarball of all the needed files can be downloaded from one of the LFS files mirrors listed at http://www.linuxfromscratch.org/mirrors.html#files.\n  The files can be downloaded using wget and a wget-list as described below.\nTo download all of the packages and patches by using wget-list as an input to the wget command, use:\n  $# wget http://www.linuxfromscratch.org/lfs/view/stable/wget-list\t#download stable wget-list $# wget --input-file=wget-list --continue --directory-prefix=$LFS/sources\t#download packages using wget-list  To check packages or download them manually:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter03/packages.html\nManually download patches:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter03/patches.html\n Total size of these packages: about 418 MB\nFinal Preparations 2 Create the required directory layout:\n$# mkdir -pv $LFS/{bin,etc,lib,sbin,usr,var} $# case $(uname -m) in  x86_64) mkdir -pv $LFS/lib64 ;;  esac In order to separate this cross-compiler from the other programs, it will be installed in a special directory. Create this directory with:\n$# mkdir -pv $LFS/tools Create new group and user:\n$# groupadd lfs $# useradd -s /bin/bash -g lfs -m -k /dev/null lfs the user and the group both called lfs\nyou can change lfs to your desired name\n Remind:\n-m : This creates a home directory for lfs.\n-k /dev/null : This parameter prevents possible copying of files from a skeleton directory (default is /etc/skel) by changing the input location to the special null device.\n $# passwd lfs\t#Set New Password Grant lfs full access to all directories under $LFS by making lfs the directory owner:\n$# chown -v lfs $LFS/{usr,lib,var,etc,bin,sbin,tools} $# case $(uname -m) in  x86_64) chown -v lfs $LFS/lib64 ;;  esac If a separate working directory was created as suggested, give user lfs ownership of this directory:\n$# chown -v lfs $LFS/sources Next, login as user lfs. This can be done via a virtual console, through a display manager, or with the following substitute/switch user command:\n$# su - lfs The “-” instructs su to start a login shell as opposed to a non-login shell. The difference between these two types of shells can be found in detail in bash(1) and info bash.\nSet up a good working environment by creating two new startup files for the bash shell. While logged in as user lfs, issue the following command to create a new .bash_profile:\n$ cat  ~/.bash_profile \"EOF\"  exec env -i HOME=$HOME TERM=$TERM PS1='\\u:\\w\\$ ' /bin/bash  EOF When logged on as user lfs, the initial shell is usually a login shell which reads the /etc/profile of the host (probably containing some settings and environment variables) and then .bash_profile. The exec env -i…/bin/bash command in the .bash_profile file replaces the running shell with a new one with a completely empty environment, except for the HOME, TERM, and PS1 variables. This ensures that no unwanted and potentially hazardous environment variables from the host system leak into the build environment. The technique used here achieves the goal of ensuring a clean environment.\nThe new instance of the shell is a non-login shell, which does not read, and execute, the contents of /etc/profile or .bash_profile files, but rather reads, and executes, the .bashrc file instead. Create the .bashrc file now:\n$ vim .bashrc paste it:\ncat  ~/.bashrc \"EOF\" set +h umask 022 LFS=/mnt/lfs LC_ALL=POSIX LFS_TGT=$(uname -m)-lfs-linux-gnu PATH=/usr/bin if [ ! -L /bin ]; then PATH=/bin:$PATH; fi PATH=$LFS/tools/bin:$PATH export LFS LC_ALL LFS_TGT PATH EOF then :wq\necho \"export MAKEFLAGS='-j4'\"  ~/.bashrc  Remind:\n  set +h\nThe set +h command turns off bash’s hash function. Hashing is ordinarily a useful feature—bash uses a hash table to remember the full path of executable files to avoid searching the PATH time and again to find the same executable. However, the new tools should be used as soon as they are installed. By switching off the hash function, the shell will always search the PATH when a program is to be run. As such, the shell will find the newly compiled tools in $LFS/tools as soon as they are available without remembering a previous version of the same program in a different location.\n  LC_ALL=POSIX\nThe LC_ALL variable controls the localization of certain programs, making their messages follow the conventions of a specified country. Setting LC_ALL to “POSIX” or “C” (the two are equivalent) ensures that everything will work as expected in the chroot environment.\n  LFS_TGT=(uname -m)-lfs-linux-gnu\nThe LFS_TGT variable sets a non-default, but compatible machine description for use when building our cross compiler and linker and when cross compiling our temporary toolchain. More information is contained in Toolchain Technical Notes.\n  PATH=/usr/bin\nMany modern linux distributions have merged /bin and /usr/bin. When this is the case, the standard PATH variable needs just to be set to /usr/bin/ for the Chapter 6 environment. When this is not the case, the following line adds /bin to the path.\n  if [ ! -L /bin ]; then PATH=/bin:$PATH; fi\nIf /bin is not a symbolic link, then it has to be added to the PATH variable.\n  PATH=$LFS/tools/bin:$PATH\nBy putting $LFS/tools/bin ahead of the standard PATH, the cross-compiler installed at the beginning of Chapter 5 is picked up by the shell immediately after its installation. This, combined with turning off hashing, limits the risk that the compiler from the host be used instead of the cross-compiler.\n  export LFS LC_ALL LFS_TGT PATH\n  While the above commands have set some variables, in order to make them visible within any sub-shells, we export them.\n  Important Several commercial distributions add a non-documented instantiation of /etc/bash.bashrc to the initialization of bash. This file has the potential to modify the lfs user’s environment in ways that can affect the building of critical LFS packages. To make sure the lfs user’s environment is clean, check for the presence of /etc/bash.bashrc and, if present, move it out of the way.\nDo:\n$# [ ! -e /etc/bash.bashrc ] || mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE\t#root user # or $ [ ! -e /etc/bash.bashrc ] || sudo mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE\t#using sudo (wheel or sudo group required) After use of the lfs user is finished at the beginning of Chapter 7, you can restore /etc/bash.bashrc (if desired).\nNote that the LFS Bash package we will build in Section 8.34, “Bash-5.0” is not configured to load or execute /etc/bash.bashrc, so this file is useless on a completed LFS system.\n Finally, to have the environment fully prepared for building the temporary tools, source the just-created user profile:\n$ source ~/.bash_profile 4. building the LFS cross toolchain and temporary tools 3  Important The build instructions assume that the Host System Requirements, including symbolic links, have been set properly:\n bash is the shell in use. sh is a symbolic link to bash. /usr/bin/awk is a symbolic link to gawk. /usr/bin/yacc is a symbolic link to bison or a small script that executes bison.  Important To re-emphasize the build process:\n Place all the sources and patches in a directory that will be accessible from the chroot environment such as /mnt/lfs/sources. Change to the sources directory. For each package:  Using the tar program, extract the package to be built. In Chapter 5 and Chapter 6, ensure you are the lfs user when extracting the package. Change to the directory created when the package was extracted. Follow the book’s instructions for building the package. Change back to the sources directory. Delete the extracted source directory unless instructed otherwise.     [Alpha] the LFS cross toolchain root user:\n$# apt install make patch build-essential cpio\n$# cd $LFS/sources\n$# chmod u-w *\n$# su - lfs\n$ cd $LFS/sources\n$ tar -xvf binutils-2.36.1.tar.xz\n$ cd binutils-2.36.1\ngoo\n$ cd ../..\n$ rm -rf binutils-2.36.1\t#to clean package tar\n$ tar -xvf gcc-10.2.0.tar.xz\n$ cd gcc-10.2.0\ngoo\n64-Bit 2CPU 2GB RAM to compile\ni dont use swap partition but i use swapfile with automatic\n refer: https://github.com/Nefelim4ag/systemd-swap\n git clone https://github.com/Nefelim4ag/systemd-swap.git cd systemd-swap make deb sudo apt install ./systemd-swap_*_all.deb systemctl enable systemd-swap\nUncomment and set swapfc_enabled=1 in the Swap File Chunked section of /etc/systemd/swap.conf.\necho “swapfc_enabled=1” » /etc/systemd/swap.conf\nsystemctl start systemd-swap\nnice low priority flag with make -j -l flag recommend\ni use nice -n 1 make -j4 -l2\nnice -n 1 make install\ncd .. cat gcc/limitx.h gcc/glimits.h gcc/limity.h  \\ `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/install-tools/include/limits.h cd ..\nrm -rf gcc-10.2.0\ntar -xvf linux-5.10.17.tar.xz\ncd linux-5.10.17\ngoo\ncd ..\nrm -rf linux-5.10.17\ntar -xvf glibc-2.33.tar.xz\ncd glibc-2.33\ngoo\ni use nice -n 1 make -j4 -l2\nnice -n 1 make DESTDIR=$LFS install\necho 'int main(){}'  dummy.c $LFS_TGT-gcc dummy.c readelf -l a.out | grep '/ld-linux' # [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2] # For 32bit: /lib/ld-linux.so.2 rm -v dummy.c a.out $LFS/tools/libexec/gcc/$LFS_TGT/10.2.0/install-tools/mkheaders\ncd ../..\nrm -rf glibc-2.33\ntar -xvf gcc-10.2.0.tar.xz\ncd gcc-10.2.0\ngoo\ni use nice -n 1 make -j4 -l2\nnice -n 1 make DESTDIR=$LFS install\ncd ../..\nrm -rf gcc-10.2.0\ntemporary tools  Remind:\nUntar, cd to it, following description and remove the finished package folders\nJust do above way as loop until binutils or gcc comming\n tar -xvf m4-1.4.18.tar.xz\ncd m4-1.4.18\ngoo\ncd ..\nrm -rf m4-1.4.18\ntar -xvf ncurses-6.2.tar.gz\ncd ncurses-6.2\ngoo\ncd ..\nrm -rf ncurses-6.2\ntar -xvf bash-5.1.tar.gz\ncd bash-5.1\ngoo\ncd ..\nrm -rf bash-5.1\ntar -xvf coreutils-8.32.tar.xz\ncd coreutils-8.32\ngoo\ncd ..\nrm -rf coreutils-8.32\ntar -xvf diffutils-3.7.tar.xz\ncd diffutils-3.7\ngoo\ncd ..\nrm -rf diffutils-3.7\ntar -xvf file-5.39.tar.gz\ncd file-5.39\ngoo\ncd ..\nrm -rf file-5.39\ntar -xvf findutils-4.8.0.tar.xz\ncd findutils-4.8.0\ngoo\ncd ..\nrm -rf findutils-4.8.0\ntar -xvf gawk-5.1.0.tar.xz\ncd gawk-5.1.0\ngoo\ncd ..\nrm -rf gawk-5.1.0\ntar -xvf grep-3.6.tar.xz\ncd grep-3.6\ngoo\ncd ..\nrm -rf grep-3.6\ntar -xvf gzip-1.10.tar.xz\ncd gzip-1.10\ngoo\ncd ..\nrm -rf gzip-1.10\ntar -xvf make-4.3.tar.gz\ncd make-4.3\ngoo\ncd ..\nrm -rf make-4.3\ntar -xvf patch-2.7.6.tar.xz\ncd patch-2.7.6\ngoo\ncd ..\nrm -rf patch-2.7.6\ntar -xvf sed-4.8.tar.xz\ncd sed-4.8\ngoo\ncd ..\nrm -rf sed-4.8\ntar -xvf tar-1.34.tar.xz\ncd tar-1.34\ngoo\ncd ..\nrm -rf tar-1.34\ntar -xvf xz-5.2.5.tar.xz\ncd xz-5.2.5\ngoo\ncd ..\nrm -rf xz-5.2.5\ntar -xvf binutils-2.36.1.tar.xz\ncd binutils-2.36.1\ngoo\ni use nice -n 1 make -j4 -l2\nnice -n 1 make DESTDIR=$LFS install\ncd ../..\nrm -rf binutils-2.36.1\ntar -xvf gcc-10.2.0.tar.xz\ncd gcc-10.2.0\ngoo\ni use nice -n 1 make -j2\nnice -n 1 make DESTDIR=$LFS install\nln -sv gcc $LFS/usr/bin/cc\ncd ../..\nrm -rf gcc-10.2.0\nEntering Chroot and Building Additional Temporary Tools back to root user\n$# echo $LFS # to check\nin root:\nchown -R root:root $LFS/{usr,lib,var,etc,bin,sbin,tools} case $(uname -m) in x86_64) chown -R root:root $LFS/lib64 ;; esac mkdir -pv $LFS/{dev,proc,sys,run} mknod -m 600 $LFS/dev/console c 5 1 mknod -m 666 $LFS/dev/null c 1 3 mount -v --bind /dev $LFS/dev mount -v --bind /dev/pts $LFS/dev/pts mount -vt proc proc $LFS/proc mount -vt sysfs sysfs $LFS/sys mount -vt tmpfs tmpfs $LFS/run if [ -h $LFS/dev/shm ]; then mkdir -pv $LFS/$(readlink $LFS/dev/shm) fi chroot \"$LFS\" /usr/bin/env -i \\ HOME=/root \\ TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login +h  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ '\nPATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login +h\n mkdir -pv /{boot,home,mnt,opt,srv} mkdir -pv /etc/{opt,sysconfig} mkdir -pv /lib/firmware mkdir -pv /media/{floppy,cdrom} mkdir -pv /usr/{,local/}{bin,include,lib,sbin,src} mkdir -pv /usr/{,local/}share/{color,dict,doc,info,locale,man} mkdir -pv /usr/{,local/}share/{misc,terminfo,zoneinfo} mkdir -pv /usr/{,local/}share/man/man{1..8} mkdir -pv /var/{cache,local,log,mail,opt,spool} mkdir -pv /var/lib/{color,misc,locate} ln -sfv /run /var/run ln -sfv /run/lock /var/lock install -dv -m 0750 /root install -dv -m 1777 /tmp /var/tmp ln -sv /proc/self/mounts /etc/mtab echo \"127.0.0.1 localhost $(hostname)\"  /etc/hosts cat  /etc/passwd cat  /etc/group echo \"tester:x:$(ls -n $(tty) | cut -d\" \" -f3):101::/home/tester:/bin/bash\"  /etc/passwd echo \"tester:x:101:\"  /etc/group install -o tester -d /home/tester exec /bin/bash --login +h  set # to check  touch /var/log/{btmp,lastlog,faillog,wtmp} chgrp -v utmp /var/log/lastlog chmod -v 664 /var/log/lastlog chmod -v 600 /var/log/btmp cd /sources\t# pls check if chrooted\ntar -xvf gcc-10.2.0.tar.xz\ncd gcc-10.2.0\ngoo Libstdc++\nnice -n 1 make\nnice -n 1 make install\ncd ../..\nrm -rf gcc-10.2.0\ntar -xvf gettext-0.21.tar.xz\ncd gettext-0.21\ngoo gettext-0.21\nnice -n 1 make\ncp -v gettext-tools/src/{msgfmt,msgmerge,xgettext} /usr/bin\ncd ..\nrm -rf gettext-0.21\ntar -xvf bison-3.7.5.tar.xz\ncd bison-3.7.5\ngoo bison-3.7.5\ncd ..\nrm -rf bison-3.7.5\ntar -xvf perl-5.32.1.tar.xz\ncd perl-5.32.1\ngoo perl-5.32.1\nnice -n 1 make\nnice -n 1 make install\ncd ..\nrm -rf perl-5.32.1\ntar -xvf Python-3.9.2.tar.xz\ncd Python-3.9.2\ngoo Python-3.9.2\n i use release here by --enable-optimizations\n./configure --prefix=/usr \\ --enable-shared \\ --without-ensurepip \\ --enable-optimizations  nice -n 1 make\nnice -n 1 make install\ncd ..\nrm -rf Python-3.9.2\ntar -xvf texinfo-6.7.tar.xz\ncd texinfo-6.7\ngoo texinfo-6.7\ncd ..\nrm -rf texinfo-6.7\ntar -xvf util-linux-2.36.2.tar.xz\ncd util-linux-2.36.2\ngoo util-linux-2.36.2\ncd ..\nrm -rf util-linux-2.36.2\nnow in chroot do:\nfind /usr/{lib,libexec} -name \\*.la -delete rm -rf /usr/share/{info,man,doc}/* exit\t# to back to root user after back to root user, do:\numount $LFS/dev{/pts,} umount $LFS/{sys,proc,run} strip --strip-debug $LFS/usr/lib/* strip --strip-unneeded $LFS/usr/{,s}bin/* strip --strip-unneeded $LFS/tools/bin/*  df -h\t#to check  Make sure $LFS has at least 600 MB free disk space (the source tarballs will be included in the backup archive) in the home directory of user root.\nmount backup disk first:\n$# mkdir -pv /mnt/lfsbackup\t#make /mnt/lfsbackup folder $# mount -v -t ext4 /dev/sda4 /mnt/lfsbackup\t#mount sda4 to /mnt/lfsbackup create backup:\ncd $LFS \u0026\u0026 tar -cJpf /mnt/lfsbackup/lfs-temp-tools-10.0.tar.xz .  i use this for backup:\ncd $LFS \u0026\u0026 tar cp . | xz -zveT4  /mnt/lfsbackup/lfs-temp-tools-10.0.tar.xz  after backup, remount LFS virtual kernel file system and re-enter chroot:\nmount -v --bind /dev $LFS/dev mount -v --bind /dev/pts $LFS/dev/pts mount -vt proc proc $LFS/proc mount -vt sysfs sysfs $LFS/sys mount -vt tmpfs tmpfs $LFS/run if [ -h $LFS/dev/shm ]; then mkdir -pv $LFS/$(readlink $LFS/dev/shm) fi chroot \"$LFS\" /usr/bin/env -i \\ HOME=/root \\ TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login +h  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ '\nPATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login +h\n 5. Building the LFS System 4 Installing Basic System Software first:\ncd /sources\ntar -xvf man-pages-5.10.tar.xz\ncd man-pages-5.10\nmake install\ncd ..\nrm -rf man-pages-5.10\ntar -xvf iana-etc-20210202.tar.gz\ncd iana-etc-20210202\ncp services protocols /etc\ncd ..\nrm -rf iana-etc-20210202\ntar -xvf glibc-2.33.tar.xz\ncd glibc-2.33\ngoo glibc-2.33\nnice -n 1 make\nnice -n 1 make check\ntouch /etc/ld.so.conf\nsed ‘/test-installation/s@$(PERL)@echo not running@’ -i ../Makefile\nnice -n 1 make install\ncp -v ../nscd/nscd.conf /etc/nscd.conf mkdir -pv /var/cache/nscd\nmkdir -pv /usr/lib/locale localedef -i POSIX -f UTF-8 C.UTF-8 2 /dev/null || true localedef -i cs_CZ -f UTF-8 cs_CZ.UTF-8 localedef -i de_DE -f ISO-8859-1 de_DE localedef -i de_DE@euro -f ISO-8859-15 de_DE@euro localedef -i de_DE -f UTF-8 de_DE.UTF-8 localedef -i el_GR -f ISO-8859-7 el_GR localedef -i en_GB -f UTF-8 en_GB.UTF-8 localedef -i en_HK -f ISO-8859-1 en_HK localedef -i en_PH -f ISO-8859-1 en_PH localedef -i en_US -f ISO-8859-1 en_US localedef -i en_US -f UTF-8 en_US.UTF-8 localedef -i es_MX -f ISO-8859-1 es_MX localedef -i fa_IR -f UTF-8 fa_IR localedef -i fr_FR -f ISO-8859-1 fr_FR localedef -i fr_FR@euro -f ISO-8859-15 fr_FR@euro localedef -i fr_FR -f UTF-8 fr_FR.UTF-8 localedef -i it_IT -f ISO-8859-1 it_IT localedef -i it_IT -f UTF-8 it_IT.UTF-8 localedef -i ja_JP -f EUC-JP ja_JP localedef -i ja_JP -f SHIFT_JIS ja_JP.SIJS 2 /dev/null || true localedef -i ja_JP -f UTF-8 ja_JP.UTF-8 localedef -i ru_RU -f KOI8-R ru_RU.KOI8-R localedef -i ru_RU -f UTF-8 ru_RU.UTF-8 localedef -i tr_TR -f UTF-8 tr_TR.UTF-8 localedef -i zh_CN -f GB18030 zh_CN.GB18030 localedef -i zh_HK -f BIG5-HKSCS zh_HK.BIG5-HKSCS\n alt, do:\nmake localedata/install-locales  cat  /etc/nsswitch.conf tar -xf ../../tzdata2021a.tar.gz ZONEINFO=/usr/share/zoneinfo mkdir -pv $ZONEINFO/{posix,right} for tz in etcetera southamerica northamerica europe africa antarctica \\ asia australasia backward; do zic -L /dev/null -d $ZONEINFO ${tz} zic -L /dev/null -d $ZONEINFO/posix ${tz} zic -L leapseconds -d $ZONEINFO/right ${tz} done cp -v zone.tab zone1970.tab iso3166.tab $ZONEINFO zic -d $ZONEINFO -p America/New_York unset ZONEINFO tzselect ln -sfv /usr/share/zoneinfo/ /etc/localtime #change the  to the selected time zone cat  /etc/ld.so.conf cat  /etc/ld.so.conf cd ../..\nrm -rf glibc-2.33\ntar -xvf zlib-1.2.11.tar.xz\ncd zlib-1.2.11\ngoo zlib-1.2.11\ncd ..\nrm -rf zlib-1.2.11\ntar -xvf bzip2-1.0.8.tar.gz\ncd bzip2-1.0.8\ngoo bzip2-1.0.8\ncd ..\nrm -rf bzip2-1.0.8\ntar -xvf xz-5.2.5.tar.xz\ncd xz-5.2.5\ngoo xz-5.2.5\ncd ..\nrm -rf xz-5.2.5\ntar -xvf zstd-1.4.8.tar.gz\ncd zstd-1.4.8\ngoo zstd-1.4.8\ncd ..\nrm -rf zstd-1.4.8\ntar -xvf file-5.39.tar.gz\ncd file-5.39\ngoo file-5.39\ncd ..\nrm -rf file-5.39\ntar -xvf readline-8.1.tar.gz\ncd readline-8.1\ngoo readline-8.1\ncd ..\nrm -rf readline-8.1\ntar -xvf m4-1.4.18.tar.xz\ncd m4-1.4.18\ngoo m4-1.4.18\ncd ..\nrm -rf m4-1.4.18\ntar -xvf bc-3.3.0.tar.xz\ncd bc-3.3.0\ngoo bc-3.3.0\ncd ..\nrm -rf bc-3.3.0\ntar -xvf flex-2.6.4.tar.gz\ncd flex-2.6.4\ngoo flex-2.6.4\ncd ..\nrm -rf flex-2.6.4\ntar -xvf tcl8.6.11-src.tar.gz\ncd tcl8.6.11\ngoo tcl8.6.11\ncd ../..\nrm -rf tcl8.6.11\ntar -xvf expect5.45.4.tar.gz\ncd expect5.45.4\ngoo expect5.45.4\ncd ..\nrm -rf expect5.45.4\ntar -xvf dejagnu-1.6.2.tar.gz\ncd dejagnu-1.6.2\ngoo dejagnu-1.6.2\ncd ..\nrm -rf dejagnu-1.6.2\ntar -xvf binutils-2.36.1.tar.xz\ncd binutils-2.36.1\ngoo binutils-2.36.1\nnice -n 1 make tooldir=/usr\nnice -n 1 make -k check\n Four tests named “Run property …” are known to fail.\n(Currently, if you had check-DEJAGNU, check-am, check-recursive, check, check-ld or do-check error; they’re all common error to test harness, which can be ignored)\nrefer:\nhttp://lists.linuxfromscratch.org/pipermail/lfs-support/2014-October/047863.html\nhttp://lists.linuxfromscratch.org/pipermail/lfs-support/2016-August/050264.html\n nice -n 1 make tooldir=/usr install\nrm -fv /usr/lib/lib{bfd,ctf,ctf-nobfd,opcodes}.a\ncd ../..\nrm -rf binutils-2.36.1\ntar -xvf gmp-6.2.1.tar.xz\ncd gmp-6.2.1\ngoo gmp-6.2.1\ncd ..\nrm -rf gmp-6.2.1\ntar -xvf mpfr-4.1.0.tar.xz\ncd mpfr-4.1.0\ngoo mpfr-4.1.0\ncd ..\nrm -rf mpfr-4.1.0\ntar -xvf mpc-1.2.1.tar.gz\ncd mpc-1.2.1\ngoo mpc-1.2.1\ncd ..\nrm -rf mpc-1.2.1\ntar -xvf attr-2.4.48.tar.gz\ncd attr-2.4.48\ngoo attr-2.4.48\ncd ..\nrm -rf attr-2.4.48\ntar -xvf acl-2.2.53.tar.gz\ncd acl-2.2.53\ngoo acl-2.2.53\ncd ..\nrm -rf acl-2.2.53\ntar -xvf libcap-2.48.tar.xz\ncd libcap-2.48\ngoo libcap-2.48\ncd ..\nrm -rf libcap-2.48\ntar -xvf shadow-4.8.1.tar.xz\ncd shadow-4.8.1\ngoo shadow-4.8.1\npwconv grpconv sed -i 's/yes/no/' /etc/default/useradd passwd root cd ..\nrm -rf shadow-4.8.1\ntar -xvf gcc-10.2.0.tar.xz\ncd gcc-10.2.0\ngoo gcc-10.2.0\nnice -n 1 make -j1\nulimit -s 32768\nchown -Rv tester . su tester -c “PATH=$PATH make -k check”\n../contrib/test_summary\nnice -n 1 make install rm -rf /usr/lib/gcc/$(gcc -dumpmachine)/10.2.0/include-fixed/bits/\nchown -v -R root:root\n/usr/lib/gcc/*linux-gnu/10.2.0/include{,-fixed}\nln -sv ../usr/bin/cpp /lib\ninstall -v -dm755 /usr/lib/bfd-plugins ln -sfv ../../libexec/gcc/$(gcc -dumpmachine)/10.2.0/liblto_plugin.so\n/usr/lib/bfd-plugins/\necho ‘int main(){}’  dummy.c cc dummy.c -v -Wl,–verbose \u0026 dummy.log readelf -l a.out | grep ‘: /lib’\ngrep -o ‘/usr/lib.*/crt[1in].*succeeded’ dummy.log\ngrep -B4 ‘^ /usr/include’ dummy.log\ngrep ‘SEARCH.*/usr/lib’ dummy.log |sed ’s|; |\\n|g’\ngrep “/lib.*/libc.so.6 \" dummy.log\ngrep found dummy.log\nrm -v dummy.c a.out dummy.log\nmkdir -pv /usr/share/gdb/auto-load/usr/lib mv -v /usr/lib/*gdb.py /usr/share/gdb/auto-load/usr/lib\ncd ../..\nrm -rf gcc-10.2.0\ntar -xvf pkg-config-0.29.2.tar.gz\ncd pkg-config-0.29.2\ngoo pkg-config-0.29.2\ncd ..\nrm -rf pkg-config-0.29.2\ntar -xvf ncurses-6.2.tar.gz\ncd ncurses-6.2\ngoo ncurses-6.2\ncd ..\nrm -rf ncurses-6.2\ntar -xvf sed-4.8.tar.xz\ncd sed-4.8\ngoo sed-4.8\ncd ..\nrm -rf sed-4.8\ntar -xvf psmisc-23.4.tar.xz\ncd psmisc-23.4\ngoo psmisc-23.4\ncd ..\nrm -rf psmisc-23.4\ntar -xvf gettext-0.21.tar.xz\ncd gettext-0.21\ngoo gettext-0.21\nnice -n 1 make\nnice -n 1 make check\nnice -n 1 make install\nchmod -v 0755 /usr/lib/preloadable_libintl.so\ncd ..\nrm -rf gettext-0.21\ntar -xvf bison-3.7.5.tar.xz\ncd bison-3.7.5\ngoo bison-3.7.5\nnice -n 1 make\nnice -n 1 make check\nnice -n 1 make install\ncd ..\nrm -rf bison-3.7.5\ntar -xvf grep-3.6.tar.xz\ncd grep-3.6\ngoo grep-3.6\ncd ..\nrm -rf grep-3.6\ntar -xvf bash-5.1.tar.gz\ncd bash-5.1\ngoo bash-5.1\nnice -n 1 make\nchown -Rv tester .\nsu tester « EOF PATH=$PATH make tests nice -n 1 make install mv -vf /usr/bin/bash /bin\nexec /bin/bash –login +h\ncd ..\nrm -rf bash-5.1\ntar -xvf libtool-2.4.6.tar.xz\ncd libtool-2.4.6\ngoo libtool-2.4.6\nnice -n 1 make\nnice -n 1 make check\nnice -n 1 make install\nrm -fv /usr/lib/libltdl.a\ncd ..\nrm -rf libtool-2.4.6\ntar -xvf gdbm-1.19.tar.gz\ncd gdbm-1.19\ngoo gdbm-1.19\ncd ..\nrm -rf gdbm-1.19\ntar -xvf gperf-3.1.tar.gz\ncd gperf-3.1\ngoo gperf-3.1\ncd ..\nrm -rf gperf-3.1\ntar -xvf expat-2.2.10.tar.xz\ncd expat-2.2.10\ngoo expat-2.2.10\ncd ..\nrm -rf expat-2.2.10\ntar -xvf inetutils-2.0.tar.xz\ncd inetutils-2.0\ngoo inetutils-2.0\ncd ..\nrm -rf inetutils-2.0\ntar -xvf perl-5.32.1.tar.xz\ncd perl-5.32.1\ngoo perl-5.32.1\nnice -n 1 make\nnice -n 1 make test\nnice -n 1 make install unset BUILD_ZLIB BUILD_BZIP2\ncd ..\nrm -rf perl-5.32.1\ntar -xvf XML-Parser-2.46.tar.gz\ncd XML-Parser-2.46\ngoo XML-Parser-2.46\ncd ..\nrm -rf XML-Parser-2.46\ntar -xvf intltool-0.51.0.tar.gz\ncd intltool-0.51.0\ngoo intltool-0.51.0\ncd ..\nrm -rf intltool-0.51.0\ntar -xvf autoconf-2.71.tar.xz\ncd autoconf-2.71\ngoo autoconf-2.71\nmake check\t# currently broken by bash-5 and libtool-2.4.3 make install\ncd ..\nrm -rf autoconf-2.71\ntar -xvf automake-1.16.3.tar.xz\ncd automake-1.16.3\ngoo automake-1.16.3\nnice -n 1 make\nnice -n 1 make -j4 check\nnice -n 1 make install\ncd ..\nrm -rf automake-1.16.3\ntar -xvf kmod-28.tar.xz\ncd kmod-28\ngoo kmod-28\ncd ..\nrm -rf kmod-28\ntar -xvf elfutils-0.183.tar.bz2\ncd elfutils-0.183\ngoo elfutils-0.183\ncd ..\nrm -rf elfutils-0.183\ntar -xvf libffi-3.3.tar.gz\ncd libffi-3.3\ngoo libffi-3.3\nnice -n 1 make\nnice -n 1 make check\nnice -n 1 make install\ncd ..\nrm -rf libffi-3.3\ntar -xvf openssl-1.1.1j.tar.gz\ncd openssl-1.1.1j\ngoo openssl-1.1.1j\nnice -n 1 make\nnice -n 1 make test\nOne test 30-test_afalg.t is known to fail on some kernel configurations (it apparently assumes certain unspecified crypto options have been selected).\nsed -i ‘/INSTALL_LIBS/s/libcrypto.a libssl.a//’ Makefile nice -n 1 make MANSUFFIX=ssl install\nmv -v /usr/share/doc/openssl /usr/share/doc/openssl-1.1.1j cp -vfr doc/* /usr/share/doc/openssl-1.1.1j\ncd ..\nrm -rf openssl-1.1.1j\ntar -xvf Python-3.9.2.tar.xz\ncd Python-3.9.2\ngoo Python-3.9.2\n i use release here by --enable-optimizations\n./configure --prefix=/usr \\ --enable-shared \\ --with-system-expat \\ --with-system-ffi \\ --with-ensurepip=yes \\ --enable-optimizations  nice -n 1 make\nnice -n 1 make install\ninstall -v -dm755 /usr/share/doc/python-3.9.2/html\ntar –strip-components=1 –no-same-owner –no-same-permissions\n-C /usr/share/doc/python-3.9.2/html\n-xvf ../python-3.9.2-docs-html.tar.bz2\ncd ..\nrm -rf Python-3.9.2\ntar -xvf ninja-1.10.2.tar.gz\ncd ninja-1.10.2\ngoo ninja-1.10.2\ncd ..\nrm -rf ninja-1.10.2\ntar -xvf meson-0.57.1.tar.gz\ncd meson-0.57.1\ngoo meson-0.57.1\ncd ..\nrm -rf meson-0.57.1\ntar -xvf coreutils-8.32.tar.xz\ncd coreutils-8.32\ngoo coreutils-8.32\nnice -n 1 make\nnice -n 1 make NON_ROOT_USERNAME=tester check-root\necho “dummy:x:102:tester” » /etc/group\nchown -Rv tester .\nsu tester -c “PATH=$PATH make RUN_EXPENSIVE_TESTS=yes check”\nThe test-getlogin test is known to fail in the LFS chroot environment.\nsed -i ‘/dummy/d’ /etc/group\nnice -n 1 make install\nmv -v /usr/bin/{cat,chgrp,chmod,chown,cp,date,dd,df,echo} /bin mv -v /usr/bin/{false,ln,ls,mkdir,mknod,mv,pwd,rm} /bin mv -v /usr/bin/{rmdir,stty,sync,true,uname} /bin mv -v /usr/bin/chroot /usr/sbin mv -v /usr/share/man/man1/chroot.1 /usr/share/man/man8/chroot.8 sed -i ’s/“1”/“8”/’ /usr/share/man/man8/chroot.8\nmv -v /usr/bin/{head,nice,sleep,touch} /bin\ncd ..\nrm -rf coreutils-8.32\ntar -xvf check-0.15.2.tar.gz\ncd check-0.15.2\ngoo check-0.15.2\nnice -n 1 make check\nnice -n 1 make docdir=/usr/share/doc/check-0.15.2 install\ncd ..\nrm -rf check-0.15.2\ntar -xvf diffutils-3.7.tar.xz\ncd diffutils-3.7\ngoo diffutils-3.7\ncd ..\nrm -rf diffutils-3.7\ntar -xvf gawk-5.1.0.tar.xz\ncd gawk-5.1.0\ngoo gawk-5.1.0\ncd ..\nrm -rf gawk-5.1.0\ntar -xvf findutils-4.8.0.tar.xz\ncd findutils-4.8.0\ngoo findutils-4.8.0\ncd ..\nrm -rf findutils-4.8.0\ntar -xvf groff-1.22.4.tar.gz\ncd groff-1.22.4\ngoo groff-1.22.4\nChoose either one:\nPAGE=letter ./configure --prefix=/usr\t#For users in the United States PAGE=A4 ./configure --prefix=/usr\t#Elsewhere make -j1\nmake install\ncd ..\nrm -rf groff-1.22.4\ntar -xvf grub-2.04.tar.xz\ncd grub-2.04\ngoo grub-2.04\ncd ..\nrm -rf grub-2.04\ntar -xvf less-563.tar.gz\ncd less-563\ngoo less-563\ncd ..\nrm -rf less-563\ntar -xvf gzip-1.10.tar.xz\ncd gzip-1.10\ngoo gzip-1.10\ncd ..\nrm -rf gzip-1.10\ntar -xvf iproute2-5.10.0.tar.xz\ncd iproute2-5.10.0\ngoo iproute2-5.10.0\ncd ..\nrm -rf iproute2-5.10.0\ntar -xvf kbd-2.4.0.tar.xz\ncd kbd-2.4.0\ngoo kbd-2.4.0\ncd ..\nrm -rf kbd-2.4.0\ntar -xvf libpipeline-1.5.3.tar.gz\ncd libpipeline-1.5.3\ngoo libpipeline-1.5.3\ncd ..\nrm -rf libpipeline-1.5.3\ntar -xvf make-4.3.tar.gz\ncd make-4.3\ngoo make-4.3\ncd ..\nrm -rf make-4.3\ntar -xvf patch-2.7.6.tar.xz\ncd patch-2.7.6\ngoo patch-2.7.6\ncd ..\nrm -rf patch-2.7.6\ntar -xvf man-db-2.9.4.tar.xz\ncd man-db-2.9.4\ngoo man-db-2.9.4\ncd ..\nrm -rf man-db-2.9.4\ntar -xvf tar-1.34.tar.xz\ncd tar-1.34\ngoo tar-1.34\nnice -n 1 make\nnice -n 1 make check\n One test, capabilities: binary store/restore, is known to fail.\n nice -n 1 make install nice -n 1 make -C doc install-html docdir=/usr/share/doc/tar-1.34\ncd ..\nrm -rf tar-1.34\ntar -xvf texinfo-6.7.tar.xz\ncd texinfo-6.7\ngoo texinfo-6.7\ncd ..\nrm -rf texinfo-6.7\n now to install Editor\nI use vim, btw\n tar -xvf vim-8.2.2433.tar.gz\ncd vim-8.2.2433\ngoo vim-8.2.2433\nnice -n 1 make\nchown -Rv tester .\nsu tester -c “LANG=en_US.UTF-8 make -j1 test” \u0026 vim-test.log\nnice -n 1 make install\nMany users are used to using vi instead of vim. To allow execution of vim when users habitually enter vi, create a symlink for both the binary and the man page in the provided languages:\nln -sv vim /usr/bin/vi for L in /usr/share/man/{,*/}man1/vim.1; do ln -sv vim.1 $(dirname $L)/vi.1 done ln -sv ../vim/vim82/doc /usr/share/doc/vim-8.2.2433\nConfiguring Vim:\ncat  /etc/vimrc  Documentation for other available options can be obtained by running the following command:\nvim -c ':options' By default, vim only installs spell files for the English language. To install spell files for your preferred language, download the *.spl and optionally, the *.sug files for your language and character encoding from ftp://ftp.vim.org/pub/vim/runtime/spell/ and save them to /usr/share/vim/vim82/spell/.\nTo use these spell files, some configuration in /etc/vimrc is needed, e.g.:\nset spelllang=en,ru set spell For more information, see the appropriate README file located at the URL above.\n cd ..\nrm -rf vim-8.2.2433\ntar -xvf eudev-3.2.10.tar.gz\ncd eudev-3.2.10\ngoo eudev-3.2.10\ncd ..\nrm -rf eudev-3.2.10\ntar -xvf procps-ng-3.3.17.tar.xz\ncd procps-3.3.17\ngoo procps-ng-3.3.17\ncd ..\nrm -rf procps-3.3.17\ntar -xvf util-linux-2.36.2.tar.xz\ncd util-linux-2.36.2\ngoo util-linux-2.36.2\nnice -n 1 make\nchown -Rv tester . su tester -c “make -k check”\nnice -n 1 make install\ncd ..\nrm -rf util-linux-2.36.2\ntar -xvf e2fsprogs-1.46.1.tar.gz\ncd e2fsprogs-1.46.1\ngoo e2fsprogs-1.46.1\nnice -n 1 make\nnice -n 1 make check\nnice -n 1 make install\nrm -fv /usr/lib/{libcom_err,libe2p,libext2fs,libss}.a\ngunzip -v /usr/share/info/libext2fs.info.gz install-info –dir-file=/usr/share/info/dir /usr/share/info/libext2fs.info\nmakeinfo -o doc/com_err.info ../lib/et/com_err.texinfo install -v -m644 doc/com_err.info /usr/share/info install-info –dir-file=/usr/share/info/dir /usr/share/info/com_err.info\ncd ../..\nrm -rf e2fsprogs-1.46.1\ntar -xvf sysklogd-1.5.1.tar.gz\ncd sysklogd-1.5.1\ngoo sysklogd-1.5.1\ncd ..\nrm -rf sysklogd-1.5.1\ntar -xvf sysvinit-2.98.tar.xz\ncd sysvinit-2.98\ngoo sysvinit-2.98\ncd ..\nrm -rf sysvinit-2.98\nALL BASIC SYSTEM SOFTWARE DONE\n df -h\t# check disk usage  Now stripping again to remove the debugging symbols from binaries and libraries (optional, but recommend for saving disk space):\nsave_lib=\"ld-2.32.so libc-2.32.so libpthread-2.32.so libthread_db-1.0.so\" cd /lib for LIB in $save_lib; do objcopy --only-keep-debug $LIB $LIB.dbg strip --strip-unneeded $LIB objcopy --add-gnu-debuglink=$LIB.dbg $LIB done save_usrlib=\"libquadmath.so.0.0.0 libstdc++.so.6.0.28 libitm.so.1.0.0 libatomic.so.1.2.0\" cd /usr/lib for LIB in $save_usrlib; do objcopy --only-keep-debug $LIB $LIB.dbg strip --strip-unneeded $LIB objcopy --add-gnu-debuglink=$LIB.dbg $LIB done unset LIB save_lib save_usrlib find /usr/lib -type f -name \\*.a \\ -exec strip --strip-debug {} ';' find /lib /usr/lib -type f -name \\*.so* ! -name \\*dbg \\ -exec strip --strip-unneeded {} ';' find /{bin,sbin} /usr/{bin,sbin,libexec} -type f \\ -exec strip --strip-all {} ';' A large number of files will be reported as having their file format not recognized. These warnings can be safely ignored. These warnings indicate that those files are scripts instead of binaries.\n df -h\t# check disk usage  After above tasks done, cleaning up temp and extra files:\nrm -rf /tmp/* Now log out and reenter the chroot environment with an updated chroot command. From now on, use this updated chroot command any time you need to reenter the chroot environment after exiting:\nlogout chroot \"$LFS\" /usr/bin/env -i \\ HOME=/root TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login\n Here the +h option is not used anymore, since all the previous programs have been replaced: hashing is therefore possible.\nIf the virtual kernel file systems have been unmounted, either manually or through a reboot, ensure that the virtual kernel file systems are mounted when reentering the chroot. This process was explained in Section 7.3.2, “Mounting and Populating /dev” and Section 7.3.3, “Mounting Virtual Kernel File Systems”.\nThere were several static libraries that were not suppressed earlier in the chapter in order to satisfy the regression tests in several packages. These libraries are from binutils, bzip2, e2fsprogs, flex, libtool, and zlib. If desired, remove them now:\nrm -f /usr/lib/lib{bfd,opcodes}.a rm -f /usr/lib/libctf{,-nobfd}.a rm -f /usr/lib/libbz2.a rm -f /usr/lib/lib{com_err,e2p,ext2fs,ss}.a rm -f /usr/lib/libltdl.a rm -f /usr/lib/libfl.a rm -f /usr/lib/libz.a There are also several files installed in the /usr/lib and /usr/libexec directories with a file name extension of .la. These are “libtool archive” files. As already said, they are only useful whe linking with static libraries. They are unneeded, and potentially harmful, when using dynamic shared libraries, specially when using also non-autotools build systems. To remove them, run:\nfind /usr/lib /usr/libexec -name \\*.la -delete For more information about libtool archive files, see the BLFS section “About Libtool Archive (.la) files”.\nThe compiler built in Chapter 6 and Chapter 7 is still partially installed and not needed anymore. Remove it with:\nfind /usr -depth -name $(uname -m)-lfs-linux-gnu\\* | xargs rm -rf The /tools directory can also be removed to further gain some place:\nrm -rf /tools Finally, remove the temporary ‘tester’ user account created at the beginning of the previous chapter.\nuserdel -r tester System Configuration make sure $LFS exported:\necho $LFS export LFS=/mnt/lfs Install LFS Bootscripts in chroot:\ncd /sources tar -xvf lfs-bootscripts-20210201.tar.xz\ncd lfs-bootscripts-20210201\ngoo lfs-bootscripts-20210201\ncd ..\nrm -rf lfs-bootscripts-20210201\nManaging Devices (optional) General Network Configuration refer: http://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html\ngo back to host root user (unchroot)\nwith:\nexit then do:\nip a to check your network interfaces\nexample output:\n1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: enp0s3:  mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3 valid_lft 73775sec preferred_lft 73775sec inet6 ::1/64 scope link noprefixroute valid_lft forever preferred_lft forever  The interface name of Ethernet, should be enpXsX or ethX\n To example, the Ethernet interface name is enp0s3\n In Kernotex’s Tutorial, because of using Gentoo LiveCD, he can copy the network config to LFS\nIn Arch, because of KISS, it should use netctl (not installed) to edit the network config\n enter to chroot:\nchroot \"$LFS\" /usr/bin/env -i \\ HOME=/root TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login\n then follow descriptions of chapter 9.5.1. Creating Network Interface Configuration Files in the link:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html\n To the example, do:\ncd /etc/sysconfig/ cat  ifconfig.enp0s3  DHCP is addressed in the BLFS book, so using ipv4-static first before DHCP configurations\n  go back to host root user (unchroot) again with:\nexit then do:\ncp /etc/resolv.conf $LFS/etc before copy the host’s hostname to LFS, the former should be set\nto set it, add /etc/hostname to include a single line with myhostname:\necho \"myhostname\"  /etc/hostname then copy it to LFS:\ncp /etc/hostname $LFS/etc copy the host’s hosts file to LFS:\ncp /etc/hosts $LFS/etc System Configuration chroot first:\nchroot \"$LFS\" /usr/bin/env -i \\ HOME=/root TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login\n The Bash Shell Startup Files refer: http://www.linuxfromscratch.org/lfs/view/stable/chapter09/profile.html\nfirst list available languages by doing:\nlocale -a  I use:\nen_US.utf8\n Charmaps can have a number of aliases, e.g., “ISO-8859-1” is also referred to as “iso8859-1” and “iso88591”. Some applications cannot handle the various synonyms correctly (e.g., require that “UTF-8” is written as “UTF-8”, not “utf8”), so it is safest in most cases to choose the canonical name for a particular locale. To determine the canonical name, run the following command, where  is the output given by locale -a for your preferred locale (“en_GB.iso88591” in our example).\nLC_ALL=locale charmap For the “en_GB.iso88591” locale, the above command will print:\nISO-8859-1 This results in a final locale setting of “en_GB.ISO-8859-1”. It is important that the locale found using the heuristic above is tested prior to it being added to the Bash startup files:\nLC_ALL=locale language LC_ALL=locale charmap LC_ALL=locale int_curr_symbol LC_ALL=locale int_prefix The above commands should print the language name, the character encoding used by the locale, the local currency, and the prefix to dial before the telephone number in order to get into the country. If any of the commands above fail with a message similar to the one shown below, this means that your locale was either not installed in Section 8.8, “Glibc-2.32” or is not supported by the default installation of Glibc.\nlocale: Cannot set LC_* to default locale: No such file or directory If this happens, you should either install the desired locale using the localedef command, or consider choosing a different locale. Further instructions assume that there are no such error messages from Glibc.\nOther packages can also function incorrectly (but may not necessarily display any error messages) if the locale name does not meet their expectations. In those cases, investigating how other Linux distributions support your locale might provide some useful information.\nOnce the proper locale settings have been determined, create the /etc/profile file:\ncat  /etc/profile _. # End /etc/profile EOF  I use:\nen_US.utf8\ncat  /etc/profile  cat /etc/profile\t＃ to check Creating the /etc/inputrc File go back to host root user (unchroot) again with:\nexit then, in host, copy /etc/inputrc to LFS:\ncp /etc/inputrc $LFS/etc  or follow the refer to make the file:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter09/inputrc.html\n Creating the /etc/shells File  go back to host root user (unchroot) again with:\nexit  then, in host, copy /etc/shells to LFS:\ncp /etc/shells $LFS/etc  or follow the refer to make the file:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter09/etcshells.html\n Making the LFS System Bootable Creating the /etc/fstab File  go back to host root user (unchroot) again with:\nexit  then, in host\ncopy /etc/fstab to LFS:\ncp /etc/fstab $LFS/etc  or follow the refer to make the file:\nhttp://www.linuxfromscratch.org/lfs/view/stable/chapter10/fstab.html\n copy i915 firmware loader to LFS:\ncp -avx /lib/firmware/i915/ $LFS/lib/firmware/ cp -avx /lib64/firmware/i915/ $LFS/lib64/firmware/ now, view the file to double check there should be no changes:\nby vim:\nvim $LFS/etc/fstab  for me\nthe host’s /etc/fstab like this:\n# /etc/fstab: static file system information. # # Use 'blkid' to print the universally unique identifier for a # device; this may be used with UUID= as a more robust way to name devices # that works even if disks are added and removed. See fstab(5). # #     # / was on /dev/sda3 during curtin installation /dev/disk/by-uuid/XXXX-XXXX-XXXX-XXXX-XXXX / ext4 defaults 0 0 # /boot was on /dev/sda2 during curtin installation /dev/disk/by-uuid/XXXX-XXXX-XXXX-XXXX-XXXX /boot ext4 defaults 0 0 # /boot/efi was on /dev/sda1 during curtin installation /dev/disk/by-uuid/XXXX-XXXX /boot/efi vfat defaults 0 0 /dev/sda4 /mnt/lfs ext4 defaults 1 1 none /dev/pts devpts defaults 0 0 if done, then :q\n The kernel - Linux-5.10.17  go back to host root user (unchroot) again with:\nexit  before chroot, copy the host’s config-X.X.X-XX-generic to $LFS/sources folder: (for Ubuntu)\ncp /boot/config-X.X.X-XX-generic $LFS/sources/.config  for Arch Linux:\nextract the host’s current kernel settings as .config to $LFS/sources folder:\nzcat /proc/config.gz  $LFS/sources/.config if the host use other distros, please search about the host distro’s .config, then copy it to $LFS/sources\n then chroot:\nchroot \"$LFS\" /usr/bin/env -i \\ HOME=/root TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login\n change directory to /sources:\ncd /sources now, do:\nnice -n 1 tar -Jxvf linux-5.10.17.tar.xz\ncd linux-5.10.17\ngoo linux-5.10.17\nmake mrproper\ncp ../.config .\nmake oldconfig\n if you don’t know how to choose options, just use defaults (uppercase)\n make menuconfig\n please checking with the doc or Kernotex’s video to make sure kernel configurations are correctly set\n  if → Device Drivers → Generic Driver Options → Firmware loader → Build named firmware blobs into the kernel binary setting is blank, input:\ni915/kbl_dmc_ver1_04.bin   For me, i recommend use Gzip (which already installed in LFS) to do kernel compression\nGeneral setup – Kernel compression mode (Gzip) —\n nice -n 1 make\n it may take much long time, be patient.\n  If it shows make[1]: *** [kernel/Makefile:144: kernel/kheaders_data.tar.xz] Error 127 or similar errors\ndisable CONFIG_IKHEADERS by:\nsearch and edit the line in .config file\nCONFIG_IKHEADERS=m to\n# CONFIG_IKHEADERS is not set  BTF: .tmp_vmlinux.btf: pahole (pahole) is not available Failed to generate BTF for vmlinux Try to disable CONFIG_DEBUG_INFO_BTF make: *** [Makefile:1139: vmlinux] Error 1 make: Target '__all' not remade because of errors.  if ‘arch/x86/boot/bzImage’ missing, do:\nmake bzImage  nice -n 1 make modules_install\n If the host system has a separate /boot partition, the files copied below should go there. The easiest way to do that is to bind /boot on the host (outside chroot) to /mnt/lfs/boot before proceeding. As the root user in the host system:\nmount --bind /boot /mnt/lfs/boot  cp -iv arch/x86/boot/bzImage /boot/vmlinuz-5.10.17-lfs-10.1\ncp -iv System.map /boot/System.map-5.10.17\ncp -iv .config /boot/config-5.10.17\ninstall -d /usr/share/doc/linux-5.10.17 cp -r Documentation/* /usr/share/doc/linux-5.10.17\nchown -R 0:0 ../linux-5.10.17\ninstall -v -m755 -d /etc/modprobe.d cat  /etc/modprobe.d/usb.conf rm ../.config\nUsing GRUB to Set Up the Boot Process follow the doc or Kernotex’s video to setup GRUB\n to copy the host’s grub config to LFS:\ngo back to host root user (unchroot) again with:\nexit then, in host, copy /boot/grub/grub.cfg to LFS:\nmkdir -p $LFS/boot/grub/ \u0026\u0026 cp /boot/grub/grub.cfg $LFS/boot/grub/ then chroot:\nchroot \"$LFS\" /usr/bin/env -i \\ HOME=/root TERM=\"$TERM\" \\ PS1='(lfs chroot) \\u:\\w\\$ ' \\ PATH=/bin:/usr/bin:/sbin:/usr/sbin \\ /bin/bash --login  I personly use:\nchroot “$LFS” /usr/bin/env -i HOME=/root TERM=\"$TERM” PS1=’(lfs chroot) \\u:\\w$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin\nMAKEFLAGS=”-j4 -l2”\n/bin/bash –login\n   Before installing GRUB as bootloader, it’s recommend to backup\nif you’re using VM, you can use snapshot to record\n [UEFI] Install GRUB (skip if GRUB already installed on host or you are using MBR, legacy BIOS, etc)\ninstalling GRUB bootloader into /dev/sda:\ngrub-install /dev/sda GRUB config examples:\nset default=0 set timeout=5 insmod ext2 set root=(hd0,2) menuentry \"GNU/Linux, Linux 5.10.17-lfs-10.1\" { linux /boot/vmlinuz-5.10.17-lfs-10.1 root=/dev/sda2 ro } for /etc/grub.d/40_custom:\nmenuentry \"GNU/Linux, Linux 5.10.17-lfs-10.1\" { load_video insmod ext2 set root=(hd0,2) linux /boot/vmlinuz-5.10.17-lfs-10.1 root=/dev/sda4 ro }  because I use UEFI in VM, GRUB had to get config from /dev/sda2’s /boot/grub directory first by:\ncp $LFS/boot/grub/grub.cfg /boot/grub/\n  to check UUID:\nblkid  Build LFS - The End refer: http://www.linuxfromscratch.org/lfs/view/stable/chapter11/theend.html\necho 10.1  /etc/lfs-release cat  /etc/lsb-release \" DISTRIB_DESCRIPTION=\"Linux From Scratch\" EOF You can customize DISTRIB_ID, DISTRIB_RELEASE, DISTRIB_CODENAME, and DISTRIB_DESCRIPTION as desire\n for me:\ncat  /etc/lsb-release « “EOF” DISTRIB_ID=\"Linux From Scratch” DISTRIB_RELEASE=\"10.1” DISTRIB_CODENAME=\"amirvincent64” DISTRIB_DESCRIPTION=\"Linux From Scratch” EOF\n cat  /etc/os-release \" EOF You can customize NAME, VERSION, ID, PRETTY_NAME, and VERSION_CODENAME as desire\n for me:\ncat  /etc/os-release « “EOF” NAME=\"Linux From Scratch” VERSION=\"10.1” ID=lfs PRETTY_NAME=\"Linux From Scratch 10.1” VERSION_CODENAME=\"amirvincent64” EOF\n Get Counted Rebooting the System Final although the kernel I built got some panic\nbut after I switch to ubuntu’s kernel, it can boot\nthat’s it. thanks for reading my notes about LFS 10.1 :-)\nPS1: Updates WIP\nPS2: Install GRUB to UEFI to the machine are in (U)EFI:\nls /sys/firmware/efi in chroot, mount the host’s boot partition to /boot/efi:\nmkdir -p /boot/efi mount -vt vfat /dev/sda1 /boot/efi Install the following BLFS packages:\nlibtasn1, p11-kit, make-ca, curl, wget.\n recommend to separate packages location between BLFS and LFS\nmake BLFS separate sources folder:\nin host:\nmkdir -p $LFS/sources/BLFS in chroot:\nmkdir -p /sources/BLFS  Install the following BLFS packages, using the instructions in the book: dosfstools, popt and pciutils.\nBuild and install FreeType if building grub with grub-mkfont enabled.\nThe BLFS FreeType instructions recommend that it be built after which and libpng have been installed.\n so it was, however, as the recommendation for “HarfBuzz” notes that one builds FreeType without it first, and then do a re-install, it wasn’t thought necessary to do the re-install.\nfor “HarfBuzz”, install these dependencies:\nPCRE, libxml2, libxslt, GLib.\n The libpng install did include the “apng” patch.\nthen follow descriptions starting from EFIVAR-37 chapter in the link:\nhttp://www.linuxfromscratch.org/hints/downloads/files/lfs-uefi.txt\n efivar currrently has a bug about lto-wrapper, to fix this, see:\nhttps://github.com/rhboot/efivar/issues/156\n Require dependencies starting from EFIVAR-37 chapter:\npopt and efivar Optional: FreeType (for grub-mkfont and unicode.pf2) unifont (for unicode.pf2)\n(WIP)\n  refer: http://www.linuxfromscratch.org/lfs/view/stable/chapter03/introduction.html (LFS 10.1 Stable) ↩︎\n refer: http://www.linuxfromscratch.org/lfs/view/stable/chapter04/chapter04.html ↩︎\n refer: http://www.linuxfromscratch.org/lfs/view/stable/part3.html ↩︎\n refer: http://www.linuxfromscratch.org/lfs/view/stable/part4.html ↩︎\n  ",
  "wordCount" : "7077",
  "inLanguage": "en",
  "image":"https://amirvincent64.github.io/images/VirtualBox_LFS_01.png","datePublished": "2021-02-16T00:00:00Z",
  "dateModified": "2021-02-16T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "amir."
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://amirvincent64.github.io/en/posts/notes-10.1-linux-from-scratch/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "amir.",
    "logo": {
      "@type": "ImageObject",
      "url": "https://amirvincent64.github.io/favicon.ico"
    }
  }
}
</script>



</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://amirvincent64.github.io/en/" accesskey="h" title="amir. (Alt + H)">amir.</a>
            <span class="logo-switches">
                <a id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </a>
                
                

                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://amirvincent64.github.io/zh-hant/" title="中"
                            aria-label="中">中</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://amirvincent64.github.io/en/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://amirvincent64.github.io/en/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://amirvincent64.github.io/en/search/" title="🔍">
                    <span>🔍</span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs">

      <a href="https://amirvincent64.github.io/en/">Home</a>&nbsp;»&nbsp;<a href="https://amirvincent64.github.io/en/posts/">Posts</a>
    </div>
    <h1 class="post-title">
      Linux From Scratch 10.1 Notes [Alpha]
    </h1>
    <div class="post-meta">

February 16, 2021&nbsp;·&nbsp;34 min&nbsp;·&nbsp;amir.

    </div>
  </header> 
<figure class="entry-cover"><img src="https://amirvincent64.github.io/images/VirtualBox_LFS_01.png" alt="">
        <p><!-- raw HTML omitted --></p>
</figure>

  <div class="toc">
    <details >
      <summary accesskey="c" title="(Alt + C)">
        <div class="details">Table of Contents</div>
      </summary>
      <div class="inner"><ul><ul><li>
        <a href="#1-download-virtualbox-and-install-it" aria-label="1. download virtualbox and install it">1. download virtualbox and install it</a></li><li>
        <a href="#2-create-hostubuntu-vm" aria-label="2. create host(ubuntu) VM">2. create host(ubuntu) VM</a><ul>
            <li>
        <a href="#second-booting" aria-label="second booting">second booting</a></li><li>
        <a href="#ssh-to-virtualbox" aria-label="ssh to virtualbox">ssh to virtualbox</a></li></ul>
    </li><li>
        <a href="#3-configure-host" aria-label="3. configure host">3. configure host</a><ul>
            <li>
        <a href="#download-needed-source-packages-and-patches-2" aria-label="Download needed source packages and patches 1">Download needed source packages and patches <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></a></li><li>
        <a href="#final-preparations-3" aria-label="Final Preparations 2">Final Preparations <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></a><ul>
            <li>
        <a href="#important" aria-label="Important">Important</a></li></ul>
    </li></ul>
    </li><li>
        <a href="#4-building-the-lfs-cross-toolchain-and-temporary-tools-4" aria-label="4. building the LFS cross toolchain and temporary tools 3">4. building the LFS cross toolchain and temporary tools <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></a><ul>
            <ul>
            <li>
        <a href="#important-1" aria-label="Important">Important</a></li><li>
        <a href="#important-2" aria-label="Important">Important</a></li></ul>
        </ul>
    </li></ul>
        <li>
        <a href="#alpha" aria-label="[Alpha]"><em><strong>[Alpha]</strong></em></a><ul>
            <ul>
            <li>
        <a href="#the-lfs-cross-toolchain" aria-label="the LFS cross toolchain">the LFS cross toolchain</a></li><li>
        <a href="#temporary-tools" aria-label="temporary tools">temporary tools</a></li><li>
        <a href="#entering-chroot-and-building-additional-temporary-tools" aria-label="Entering Chroot and Building Additional Temporary Tools">Entering Chroot and Building Additional Temporary Tools</a></li></ul>
        <li>
        <a href="#5-building-the-lfs-system-5" aria-label="5. Building the LFS System 4">5. Building the LFS System <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup></a><ul>
            <li>
        <a href="#installing-basic-system-software" aria-label="Installing Basic System Software">Installing Basic System Software</a></li><li>
        <a href="#system-configuration" aria-label="System Configuration">System Configuration</a><ul>
            <li>
        <a href="#install-lfs-bootscripts" aria-label="Install LFS Bootscripts">Install LFS Bootscripts</a></li><li>
        <a href="#managing-devices-optionalhttpwwwlinuxfromscratchorglfsviewstablechapter09symlinkshtml" aria-label="Managing Devices (optional)"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/symlinks.html">Managing Devices (optional)</a></a></li><li>
        <a href="#general-network-configuration" aria-label="General Network Configuration">General Network Configuration</a></li><li>
        <a href="#system-configurationhttpwwwlinuxfromscratchorglfsviewstablechapter09usagehtml" aria-label="System Configuration"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/usage.html">System Configuration</a></a></li><li>
        <a href="#the-bash-shell-startup-files" aria-label="The Bash Shell Startup Files">The Bash Shell Startup Files</a></li><li>
        <a href="#creating-the-etcinputrc-file" aria-label="Creating the /etc/inputrc File">Creating the /etc/inputrc File</a></li><li>
        <a href="#creating-the-etcshells-file" aria-label="Creating the /etc/shells File">Creating the /etc/shells File</a></li></ul>
    </li><li>
        <a href="#making-the-lfs-system-bootable" aria-label="Making the LFS System Bootable">Making the LFS System Bootable</a><ul>
            <li>
        <a href="#creating-the-etcfstab-filehttpwwwlinuxfromscratchorglfsviewstablechapter10fstabhtml" aria-label="Creating the /etc/fstab File"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/fstab.html">Creating the /etc/fstab File</a></a></li><li>
        <a href="#the-kernel---linux-51017httpwwwlinuxfromscratchorglfsviewstablechapter10kernelhtml" aria-label="The kernel - Linux-5.10.17"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/kernel.html">The kernel - Linux-5.10.17</a></a></li><li>
        <a href="#using-grub-to-set-up-the-boot-process" aria-label="Using GRUB to Set Up the Boot Process">Using GRUB to Set Up the Boot Process</a></li></ul>
    </li><li>
        <a href="#build-lfs---the-end" aria-label="Build LFS - The End">Build LFS - The End</a><ul>
            <li>
        <a href="#get-countedhttpwwwlinuxfromscratchorglfsviewstablechapter11getcountedhtml" aria-label="Get Counted"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter11/getcounted.html">Get Counted</a></a></li><li>
        <a href="#rebooting-the-systemhttpwwwlinuxfromscratchorglfsviewstablechapter11reboothtml" aria-label="Rebooting the System"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter11/reboot.html">Rebooting the System</a></a></li></ul>
    </li></ul>
    </li><li>
        <a href="#final" aria-label="Final">Final</a></li><li>
        <a href="#ps1-updates" aria-label="PS1: Updates">PS1: Updates</a></li><li>
        <a href="#ps2-install-grub-to-uefihttpwwwlinuxfromscratchorghintsdownloadsfileslfs-uefitxt" aria-label="PS2: Install GRUB to UEFI"><a href="http://www.linuxfromscratch.org/hints/downloads/files/lfs-uefi.txt">PS2: Install GRUB to UEFI</a></a></li></ul>
</li></ul>
      </div>
    </details>
  </div>
  <div class="post-content">
<p>My notes about how to Linux From Scratch (10.1 Stable)</p>
<p><em>for full doc:</em></p>
<p><em><a href="http://www.linuxfromscratch.org/lfs/read.html">http://www.linuxfromscratch.org/lfs/read.html</a></em></p>
<p><em>if video tutorial needed, here comes playlist made by <a href="https://www.youtube.com/c/Kernotex">Kernotex</a>:</em></p>
<p><em><a href="https://youtube.com/playlist?list=PLyc5xVO2uDsAlIkKBIGauDQ6LejoQovyL">https://youtube.com/playlist?list=PLyc5xVO2uDsAlIkKBIGauDQ6LejoQovyL</a></em></p>
<hr>
<p>there&rsquo;s a meme:</p>
<p><img src="https://i.imgur.com/fp7uBnM.jpg" alt="When I try Linux from Scratch"></p>
<p>and here&rsquo;s how i did:</p>
<h2 id="1-download-virtualbox-and-install-it">1. download virtualbox and install it<a hidden class="anchor" aria-hidden="true" href="#1-download-virtualbox-and-install-it">#</a></h2>
<p><a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>
<blockquote>
<p>if you don&rsquo;t know how to install and use, google it :-)</p>
</blockquote>
<h2 id="2-create-hostubuntu-vm">2. create host(ubuntu) VM<a hidden class="anchor" aria-hidden="true" href="#2-create-hostubuntu-vm">#</a></h2>
<p><strong>Download Ubuntu Server LiveCD: <a href="https://ubuntu.com/download/server">https://ubuntu.com/download/server</a></strong></p>
<p>Manual server installation -&gt; Download Ubuntu Server LTS</p>
<p>I use :</p>
<p>32G <code>.vdi</code> image</p>
<p>UEFI: <code>ON</code></p>
<p>choose manual partition</p>
<p>my setup:</p>
<p>/dev/sda1 512M vfat for /boot/efi</p>
<p>/dev/sda2 488M ext4 for /boot/</p>
<p>/dev/sda3 4G ext4 for ubuntu host</p>
<p>/dev/sda4 26G ext4 for LFS root</p>
<p>/dev/sda5 1G ext4 for LFS backup</p>
<h3 id="second-booting">second booting<a hidden class="anchor" aria-hidden="true" href="#second-booting">#</a></h3>
<p>select <code>Ubuntu</code></p>
<p>then login</p>
<p>and enter the password</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt full-upgrade	<span style="color:#75715e">#to update packages and upgrade packages to lastest</span>
</code></pre></div><h3 id="ssh-to-virtualbox">ssh to virtualbox<a hidden class="anchor" aria-hidden="true" href="#ssh-to-virtualbox">#</a></h3>
<p><em>(optional but recommend, if still not installed)</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt install openssh
$ systemctl start sshd	<span style="color:#75715e">#start server</span>
$ systemctl enable sshd	<span style="color:#75715e">#to start it when boot</span>
</code></pre></div><p>then go here to see how to configure VM network:</p>
<p><a href="https://dev.to/yassineselllami/how-to-ssh-into-ubuntu-vm-virtualbox-from-host-machine-1kii">https://dev.to/yassineselllami/how-to-ssh-into-ubuntu-vm-virtualbox-from-host-machine-1kii</a></p>
<h2 id="3-configure-host">3. configure host<a hidden class="anchor" aria-hidden="true" href="#3-configure-host">#</a></h2>
<p>to check the requires:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl -sL https://github.com/viktomas/linux-from-scratch/raw/master/version-check.sh | bash
</code></pre></div><pre><code>sudo su -
ln -svf /usr/bin/bash /bin/sh
</code></pre><p>For LFS 10.1 install require packages:</p>
<pre><code>sudo apt install binutils bison gawk gcc g++ make texinfo build-essential
</code></pre><pre><code>sudo su -
</code></pre><p>Set $LFS:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# export LFS<span style="color:#f92672">=</span>/mnt/lfs
</code></pre></div><blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# echo $LFS	<span style="color:#75715e">#to check export</span>
</code></pre></div></blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# mkdir -pv $LFS	<span style="color:#75715e">#make $LFS folder</span>
$# mount -v -t ext4 /dev/sda4 $LFS	<span style="color:#75715e">#mount sda4 to $LFS</span>
$# mkdir -pv /mnt/lfsbackup	<span style="color:#75715e">#make /mnt/lfsbackup folder</span>
$# mount -v -t ext4 /dev/sda5 /mnt/lfsbackup	<span style="color:#75715e">#mount sda5 to /mnt/lfsbackup</span>
</code></pre></div><blockquote>
<p>to prevent unmount when reboot, halt; add your LFS partition to /etc/fstab, for example:</p>
<p>add</p>
<pre><code>/dev/&lt;xxx&gt;	/mnt/lfs ext4	defaults	1	1
</code></pre></blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# mkdir -v $LFS/sources	<span style="color:#75715e">#make folder for sources</span>
$# chmod -v a+wt $LFS/sources	<span style="color:#75715e">#to add write permission and sticky mark</span>
</code></pre></div><h3 id="download-needed-source-packages-and-patches-2">Download needed source packages and patches <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup><a hidden class="anchor" aria-hidden="true" href="#download-needed-source-packages-and-patches-2">#</a></h3>
<p>First install <code>wget</code> if not installed:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt install wget
</code></pre></div><p>There are several ways to optain all the necessary packages and patches to build LFS:</p>
<ul>
<li>
<p>The files can be downloaded individually as described in the next two sections.</p>
</li>
<li>
<p>For stable versions of the book, a tarball of all the needed files can be downloaded from one of the LFS files mirrors listed at <a href="http://www.linuxfromscratch.org/mirrors.html#files">http://www.linuxfromscratch.org/mirrors.html#files</a>.</p>
</li>
<li>
<p>The files can be downloaded using <strong>wget</strong> and a wget-list as described below.</p>
<p>To download all of the packages and patches by using <a href="http://www.linuxfromscratch.org/lfs/view/stable/wget-list">wget-list</a> as an input to the <strong>wget</strong> command, use:</p>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# wget http://www.linuxfromscratch.org/lfs/view/stable/wget-list	<span style="color:#75715e">#download stable wget-list</span>
$# wget --input-file<span style="color:#f92672">=</span>wget-list --continue --directory-prefix<span style="color:#f92672">=</span>$LFS/sources	<span style="color:#75715e">#download packages using wget-list</span>
</code></pre></div><blockquote>
<p><strong>To check packages or download them manually:</strong></p>
<p><strong><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter03/packages.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter03/packages.html</a></strong></p>
<p><strong>Manually download patches:</strong></p>
<p><strong><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter03/patches.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter03/patches.html</a></strong></p>
</blockquote>
<p>Total size of these packages: about 418 MB</p>
<h3 id="final-preparations-3">Final Preparations <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup><a hidden class="anchor" aria-hidden="true" href="#final-preparations-3">#</a></h3>
<p>Create the required directory layout:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# mkdir -pv $LFS/<span style="color:#f92672">{</span>bin,etc,lib,sbin,usr,var<span style="color:#f92672">}</span>
$# <span style="color:#66d9ef">case</span> <span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span> in
&gt;  x86_64<span style="color:#f92672">)</span> mkdir -pv $LFS/lib64 ;;
&gt;  <span style="color:#66d9ef">esac</span>
</code></pre></div><p>In order to separate this cross-compiler from the other programs, it will be installed in a special directory. Create this directory with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# mkdir -pv $LFS/tools
</code></pre></div><p>Create new group and user:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# groupadd lfs
$# useradd -s /bin/bash -g lfs -m -k /dev/null lfs
</code></pre></div><p>the user and the group both called <code>lfs</code></p>
<p>you can change <code>lfs</code> to your desired name</p>
<blockquote>
<p>Remind:</p>
<p><em><code>-m</code></em> : This creates a home directory for <code>lfs</code>.</p>
<p><em><code>-k /dev/null</code></em> : This parameter prevents possible copying of files from a skeleton directory (default is <code>/etc/skel</code>) by changing the input location to the special null device.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# passwd lfs	<span style="color:#75715e">#Set New Password</span>
</code></pre></div><p>Grant <code>lfs</code> full access to all directories under <code>$LFS</code> by making <code>lfs</code> the directory owner:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# chown -v lfs $LFS/<span style="color:#f92672">{</span>usr,lib,var,etc,bin,sbin,tools<span style="color:#f92672">}</span>
$# <span style="color:#66d9ef">case</span> <span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span> in
&gt;  x86_64<span style="color:#f92672">)</span> chown -v lfs $LFS/lib64 ;;
&gt;  <span style="color:#66d9ef">esac</span>
</code></pre></div><p>If a separate working directory was created as suggested, give user <code>lfs</code> ownership of this directory:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# chown -v lfs $LFS/sources
</code></pre></div><p>Next, login as user <code>lfs</code>. This can be done via a virtual console, through a display manager, or with the following substitute/switch user command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# su - lfs
</code></pre></div><p>The “<em><code>-</code></em>” instructs <strong>su</strong> to start a login shell as opposed to a non-login shell. The difference between these two types of shells can be found in detail in <code>bash(1)</code> and <strong>info bash</strong>.</p>
<p>Set up a good working environment by creating two new startup files for the <strong>bash</strong> shell. While logged in as user <code>lfs</code>, issue        the following command to create a new <code>.bash_profile</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat &gt; ~/.bash_profile &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
&gt; exec env -i HOME<span style="color:#f92672">=</span>$HOME TERM<span style="color:#f92672">=</span>$TERM PS1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;\u:\w\$ &#39;</span> /bin/bash
&gt; EOF
</code></pre></div><p>When logged on as user <code>lfs</code>, the initial shell is usually a <em>login</em> shell which reads the <code>/etc/profile</code> of the host (probably containing some settings and environment variables) and then <code>.bash_profile</code>. The <strong>exec env -i&hellip;/bin/bash</strong> command in the <code>.bash_profile</code> file replaces the running shell with a new one with a completely empty environment, except for the <code>HOME</code>, <code>TERM</code>, and <code>PS1</code> variables. This ensures that no unwanted and potentially hazardous environment variables from the host system leak into the build environment. The technique used here achieves the goal of ensuring a clean environment.</p>
<p>The new instance of the shell is a <em>non-login</em> shell, which does not read, and execute, the contents of <code>/etc/profile</code> or <code>.bash_profile</code> files, but rather reads, and executes, the <code>.bashrc</code> file instead. Create the <code>.bashrc</code> file now:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ vim .bashrc
</code></pre></div><p>paste it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat &gt; ~/.bashrc &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
set +h
umask <span style="color:#ae81ff">022</span>
LFS<span style="color:#f92672">=</span>/mnt/lfs
LC_ALL<span style="color:#f92672">=</span>POSIX
LFS_TGT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span>-lfs-linux-gnu
PATH<span style="color:#f92672">=</span>/usr/bin
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -L /bin <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span> PATH<span style="color:#f92672">=</span>/bin:$PATH; <span style="color:#66d9ef">fi</span>
PATH<span style="color:#f92672">=</span>$LFS/tools/bin:$PATH
export LFS LC_ALL LFS_TGT PATH
EOF
</code></pre></div><p>then <code>:wq</code></p>
<pre><code>echo &quot;export MAKEFLAGS='-j4'&quot; &gt;&gt; ~/.bashrc
</code></pre><blockquote>
<p>Remind:</p>
<ul>
<li>
<p><em><code>set +h</code></em></p>
<p>The <strong>set +h</strong> command turns off <strong>bash</strong>&rsquo;s hash function. Hashing is ordinarily a useful feature—<strong>bash</strong> uses a hash table to              remember the full path of executable files to avoid searching the <code>PATH</code> time and again to find the same executable. However, the new tools should be used as soon as they are installed. By switching off the hash function, the shell will always search the <code>PATH</code> when a program is to be run. As such, the shell will find the newly compiled tools in <code>$LFS/tools</code> as soon as they are available without remembering a previous version of the same program in a different location.</p>
</li>
<li>
<p><em><code>LC_ALL=POSIX</code></em></p>
<p>The <code>LC_ALL</code> variable controls the localization of certain programs, making their messages follow the conventions of a specified country. Setting <code>LC_ALL</code> to “POSIX” or “C” (the two are equivalent) ensures that everything will work as expected in the chroot environment.</p>
</li>
<li>
<p><em><code>LFS_TGT=(uname -m)-lfs-linux-gnu</code></em></p>
<p>The <code>LFS_TGT</code> variable sets a non-default, but compatible machine description for use when building our cross compiler and linker and when cross compiling our temporary toolchain. More information is contained in <a href="http://www.linuxfromscratch.org/lfs/view/stable/partintro/toolchaintechnotes.html">Toolchain Technical Notes</a>.</p>
</li>
<li>
<p><em><code>PATH=/usr/bin</code></em></p>
<p>Many modern linux distributions have merged <code>/bin</code> and <code>/usr/bin</code>. When this is the case, the standard <code>PATH</code> variable needs just to be set to <code>/usr/bin/</code> for the <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter06/chapter06.html">Chapter 6</a> environment. When this is not the case, the following line adds              <code>/bin</code> to the path.</p>
</li>
<li>
<p><em><code>if [ ! -L /bin ]; then PATH=/bin:$PATH; fi</code></em></p>
<p>If <code>/bin</code> is not a symbolic link, then it has to be added to the <code>PATH</code> variable.</p>
</li>
<li>
<p><em><code>PATH=$LFS/tools/bin:$PATH</code></em></p>
<p>By putting <code>$LFS/tools/bin</code> ahead of the standard <code>PATH</code>, the cross-compiler installed at the beginning of <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter05/chapter05.html">Chapter 5</a> is picked up by the shell immediately after its installation. This, combined with turning off hashing, limits the risk that the compiler from the host be used instead of the cross-compiler.</p>
</li>
<li>
<p><em><code>export LFS LC_ALL LFS_TGT PATH</code></em></p>
</li>
</ul>
<p>While the above commands have set some variables, in order to make them visible within any sub-shells, we export them.</p>
</blockquote>
<blockquote>
<p><img src="http://www.linuxfromscratch.org/lfs/view/stable/images/important.png" alt="[Important]"></p>
<h4 id="important">Important<a hidden class="anchor" aria-hidden="true" href="#important">#</a></h4>
<p>Several commercial distributions add a non-documented instantiation  of <code>/etc/bash.bashrc</code> to the initialization of <strong>bash</strong>. This file has the potential to modify the <code>lfs</code> user&rsquo;s environment in ways that can affect the building of critical LFS packages. To make sure the <code>lfs</code> user&rsquo;s environment is clean, check for the presence of <code>/etc/bash.bashrc</code> and, if present, move it out of the way.</p>
<p>Do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$# <span style="color:#f92672">[</span> ! -e /etc/bash.bashrc <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE	<span style="color:#75715e">#root user</span>
<span style="color:#75715e"># or</span>
$ <span style="color:#f92672">[</span> ! -e /etc/bash.bashrc <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> sudo mv -v /etc/bash.bashrc /etc/bash.bashrc.NOUSE	<span style="color:#75715e">#using sudo (wheel or sudo group required)</span>
</code></pre></div><p>After use of the <code>lfs</code> user is finished at the beginning of <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/chapter07.html">Chapter 7</a>, you can restore <code>/etc/bash.bashrc</code> (if desired).</p>
<p>Note that the LFS Bash package we will build in <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/bash.html">Section 8.34, “Bash-5.0”</a>  is not configured to load or execute <code>/etc/bash.bashrc</code>, so this file is useless on a completed LFS system.</p>
</blockquote>
<p>Finally, to have the environment fully prepared for building the temporary tools, source the just-created user profile:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ source ~/.bash_profile
</code></pre></div><h2 id="4-building-the-lfs-cross-toolchain-and-temporary-tools-4">4. building the LFS cross toolchain and temporary tools <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup><a hidden class="anchor" aria-hidden="true" href="#4-building-the-lfs-cross-toolchain-and-temporary-tools-4">#</a></h2>
<blockquote>
<p><img src="http://www.linuxfromscratch.org/lfs/view/stable/images/important.png" alt="[Important]"></p>
<h4 id="important-1">Important<a hidden class="anchor" aria-hidden="true" href="#important-1">#</a></h4>
<p>The build instructions assume that the <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter02/hostreqs.html">Host System Requirements</a>, including symbolic links, have been set properly:</p>
<ul>
<li><strong>bash</strong> is the shell in use.</li>
<li><strong>sh</strong> is a symbolic link to <strong>bash</strong>.</li>
<li><strong>/usr/bin/awk</strong> is a symbolic link to <strong>gawk</strong>.</li>
<li><strong>/usr/bin/yacc</strong> is a symbolic link to <strong>bison</strong> or a small script that executes bison.</li>
</ul>
<p><img src="http://www.linuxfromscratch.org/lfs/view/stable/images/important.png" alt="[Important]"></p>
<h4 id="important-2">Important<a hidden class="anchor" aria-hidden="true" href="#important-2">#</a></h4>
<p>To re-emphasize the build process:</p>
<ol>
<li>Place all the sources and patches in a directory that will be accessible from the chroot environment such as <code>/mnt/lfs/sources</code>.</li>
<li>Change to the sources directory.</li>
<li>For each package:
<ol>
<li>Using the <strong>tar</strong> program, extract the package to be built. In <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter05/chapter05.html">Chapter 5</a> and <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter06/chapter06.html">Chapter 6</a>, ensure you are the <em>lfs</em> user when extracting the package.</li>
<li>Change to the directory created when the package was extracted.</li>
<li>Follow the book&rsquo;s instructions for building the package.</li>
<li>Change back to the sources directory.</li>
<li>Delete the extracted source directory unless instructed otherwise.</li>
</ol>
</li>
</ol>
</blockquote>
<h1 id="alpha"><em><strong>[Alpha]</strong></em><a hidden class="anchor" aria-hidden="true" href="#alpha">#</a></h1>
<h3 id="the-lfs-cross-toolchain">the LFS cross toolchain<a hidden class="anchor" aria-hidden="true" href="#the-lfs-cross-toolchain">#</a></h3>
<p>root user:</p>
<p>$# apt install make patch build-essential cpio</p>
<p>$# cd $LFS/sources</p>
<p>$# chmod u-w *</p>
<p>$# su - lfs</p>
<p>$ cd $LFS/sources</p>
<p>$ tar -xvf binutils-2.36.1.tar.xz</p>
<p>$ cd binutils-2.36.1</p>
<p>goo</p>
<p>$ cd ../..</p>
<p>$ rm -rf binutils-2.36.1	#to clean package tar</p>
<p>$ tar -xvf gcc-10.2.0.tar.xz</p>
<p>$ cd gcc-10.2.0</p>
<p>goo</p>
<p>64-Bit 2CPU 2GB RAM to compile</p>
<p>i dont use swap partition but i use swapfile with automatic</p>
<blockquote>
<p>refer: <a href="https://github.com/Nefelim4ag/systemd-swap">https://github.com/Nefelim4ag/systemd-swap</a></p>
</blockquote>
<pre><code>git clone https://github.com/Nefelim4ag/systemd-swap.git
cd systemd-swap
make deb
sudo apt install ./systemd-swap_*_all.deb
</code></pre><p>systemctl enable systemd-swap</p>
<p>Uncomment and set <code>swapfc_enabled=1</code> in the <em>Swap File Chunked</em> section of <code>/etc/systemd/swap.conf</code>.</p>
<p>echo &ldquo;swapfc_enabled=1&rdquo; &raquo; /etc/systemd/swap.conf</p>
<p>systemctl start systemd-swap</p>
<p>nice low priority flag with make -j -l flag recommend</p>
<p>i use nice -n 1 make -j4 -l2</p>
<p>nice -n 1 make install</p>
<pre><code>cd ..
cat gcc/limitx.h gcc/glimits.h gcc/limity.h &gt; \
  `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/install-tools/include/limits.h
</code></pre><p>cd ..</p>
<p>rm -rf gcc-10.2.0</p>
<p>tar -xvf linux-5.10.17.tar.xz</p>
<p>cd linux-5.10.17</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf linux-5.10.17</p>
<p>tar -xvf glibc-2.33.tar.xz</p>
<p>cd glibc-2.33</p>
<p>goo</p>
<p>i use nice -n 1 make -j4 -l2</p>
<p>nice -n 1 make DESTDIR=$LFS install</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo <span style="color:#e6db74">&#39;int main(){}&#39;</span> &gt; dummy.c
$LFS_TGT-gcc dummy.c
readelf -l a.out | grep <span style="color:#e6db74">&#39;/ld-linux&#39;</span>

<span style="color:#75715e"># [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]</span>
<span style="color:#75715e"># For 32bit: /lib/ld-linux.so.2</span>

rm -v dummy.c a.out
</code></pre></div><p>$LFS/tools/libexec/gcc/$LFS_TGT/10.2.0/install-tools/mkheaders</p>
<p>cd ../..</p>
<p>rm -rf glibc-2.33</p>
<p>tar -xvf gcc-10.2.0.tar.xz</p>
<p>cd gcc-10.2.0</p>
<p>goo</p>
<p>i use nice -n 1 make -j4 -l2</p>
<p>nice -n 1 make DESTDIR=$LFS install</p>
<p>cd ../..</p>
<p>rm -rf gcc-10.2.0</p>
<h3 id="temporary-tools">temporary tools<a hidden class="anchor" aria-hidden="true" href="#temporary-tools">#</a></h3>
<blockquote>
<p>Remind:</p>
<p>Untar, cd to it, following description and remove the finished package folders</p>
<p>Just do above way as loop until binutils or gcc comming</p>
</blockquote>
<p>tar -xvf m4-1.4.18.tar.xz</p>
<p>cd m4-1.4.18</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf m4-1.4.18</p>
<p>tar -xvf ncurses-6.2.tar.gz</p>
<p>cd ncurses-6.2</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf ncurses-6.2</p>
<p>tar -xvf bash-5.1.tar.gz</p>
<p>cd bash-5.1</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf bash-5.1</p>
<p>tar -xvf coreutils-8.32.tar.xz</p>
<p>cd coreutils-8.32</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf coreutils-8.32</p>
<p>tar -xvf diffutils-3.7.tar.xz</p>
<p>cd diffutils-3.7</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf diffutils-3.7</p>
<p>tar -xvf file-5.39.tar.gz</p>
<p>cd file-5.39</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf file-5.39</p>
<p>tar -xvf findutils-4.8.0.tar.xz</p>
<p>cd findutils-4.8.0</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf findutils-4.8.0</p>
<p>tar -xvf gawk-5.1.0.tar.xz</p>
<p>cd gawk-5.1.0</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf gawk-5.1.0</p>
<p>tar -xvf grep-3.6.tar.xz</p>
<p>cd grep-3.6</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf grep-3.6</p>
<p>tar -xvf gzip-1.10.tar.xz</p>
<p>cd gzip-1.10</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf gzip-1.10</p>
<p>tar -xvf make-4.3.tar.gz</p>
<p>cd make-4.3</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf  make-4.3</p>
<p>tar -xvf patch-2.7.6.tar.xz</p>
<p>cd patch-2.7.6</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf patch-2.7.6</p>
<p>tar -xvf sed-4.8.tar.xz</p>
<p>cd sed-4.8</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf sed-4.8</p>
<p>tar -xvf tar-1.34.tar.xz</p>
<p>cd tar-1.34</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf tar-1.34</p>
<p>tar -xvf xz-5.2.5.tar.xz</p>
<p>cd xz-5.2.5</p>
<p>goo</p>
<p>cd ..</p>
<p>rm -rf xz-5.2.5</p>
<p>tar -xvf binutils-2.36.1.tar.xz</p>
<p>cd binutils-2.36.1</p>
<p>goo</p>
<p>i use nice -n 1 make -j4 -l2</p>
<p>nice -n 1 make DESTDIR=$LFS install</p>
<p>cd ../..</p>
<p>rm -rf binutils-2.36.1</p>
<p>tar -xvf gcc-10.2.0.tar.xz</p>
<p>cd gcc-10.2.0</p>
<p>goo</p>
<p>i use nice -n 1 make -j2</p>
<p>nice -n 1 make DESTDIR=$LFS install</p>
<p>ln -sv gcc $LFS/usr/bin/cc</p>
<p>cd ../..</p>
<p>rm -rf gcc-10.2.0</p>
<h3 id="entering-chroot-and-building-additional-temporary-tools">Entering Chroot and Building Additional Temporary Tools<a hidden class="anchor" aria-hidden="true" href="#entering-chroot-and-building-additional-temporary-tools">#</a></h3>
<p>back to root user</p>
<p>$# echo $LFS # to check</p>
<p>in root:</p>
<pre><code>chown -R root:root $LFS/{usr,lib,var,etc,bin,sbin,tools}
case $(uname -m) in
  x86_64) chown -R root:root $LFS/lib64 ;;
esac
</code></pre><pre><code>mkdir -pv $LFS/{dev,proc,sys,run}
</code></pre><pre><code>mknod -m 600 $LFS/dev/console c 5 1
mknod -m 666 $LFS/dev/null c 1 3
</code></pre><pre><code>mount -v --bind /dev $LFS/dev
</code></pre><pre><code>mount -v --bind /dev/pts $LFS/dev/pts
mount -vt proc proc $LFS/proc
mount -vt sysfs sysfs $LFS/sys
mount -vt tmpfs tmpfs $LFS/run
</code></pre><pre><code>if [ -h $LFS/dev/shm ]; then
  mkdir -pv $LFS/$(readlink $LFS/dev/shm)
fi
</code></pre><pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i   \
    HOME=/root                  \
    TERM=&quot;$TERM&quot;                \
    PS1='(lfs chroot) \u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login +h
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i  <br>
HOME=/root                 <br>
TERM=&quot;$TERM&rdquo;               <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '<br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login +h</p>
</blockquote>
<pre><code>mkdir -pv /{boot,home,mnt,opt,srv}
</code></pre><pre><code>mkdir -pv /etc/{opt,sysconfig}
mkdir -pv /lib/firmware
mkdir -pv /media/{floppy,cdrom}
mkdir -pv /usr/{,local/}{bin,include,lib,sbin,src}
mkdir -pv /usr/{,local/}share/{color,dict,doc,info,locale,man}
mkdir -pv /usr/{,local/}share/{misc,terminfo,zoneinfo}
mkdir -pv /usr/{,local/}share/man/man{1..8}
mkdir -pv /var/{cache,local,log,mail,opt,spool}
mkdir -pv /var/lib/{color,misc,locate}

ln -sfv /run /var/run
ln -sfv /run/lock /var/lock

install -dv -m 0750 /root
install -dv -m 1777 /tmp /var/tmp
</code></pre><pre><code>ln -sv /proc/self/mounts /etc/mtab
</code></pre><pre><code>echo &quot;127.0.0.1 localhost $(hostname)&quot; &gt; /etc/hosts
</code></pre><pre><code>cat &gt; /etc/passwd &lt;&lt; &quot;EOF&quot;
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/dev/null:/bin/false
daemon:x:6:6:Daemon User:/dev/null:/bin/false
messagebus:x:18:18:D-Bus Message Daemon User:/var/run/dbus:/bin/false
nobody:x:99:99:Unprivileged User:/dev/null:/bin/false
EOF
</code></pre><pre><code>cat &gt; /etc/group &lt;&lt; &quot;EOF&quot;
root:x:0:
bin:x:1:daemon
sys:x:2:
kmem:x:3:
tape:x:4:
tty:x:5:
daemon:x:6:
floppy:x:7:
disk:x:8:
lp:x:9:
dialout:x:10:
audio:x:11:
video:x:12:
utmp:x:13:
usb:x:14:
cdrom:x:15:
adm:x:16:
messagebus:x:18:
input:x:24:
mail:x:34:
kvm:x:61:
wheel:x:97:
nogroup:x:99:
users:x:999:
EOF
</code></pre><pre><code>echo &quot;tester:x:$(ls -n $(tty) | cut -d&quot; &quot; -f3):101::/home/tester:/bin/bash&quot; &gt;&gt; /etc/passwd
echo &quot;tester:x:101:&quot; &gt;&gt; /etc/group
install -o tester -d /home/tester
</code></pre><pre><code>exec /bin/bash --login +h
</code></pre><blockquote>
<pre><code>set # to check
</code></pre></blockquote>
<pre><code>touch /var/log/{btmp,lastlog,faillog,wtmp}
chgrp -v utmp /var/log/lastlog
chmod -v 664  /var/log/lastlog
chmod -v 600  /var/log/btmp
</code></pre><p>cd /sources	# pls check if chrooted</p>
<p>tar -xvf gcc-10.2.0.tar.xz</p>
<p>cd gcc-10.2.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/gcc-libstdc++-pass2.html">Libstdc++</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make install</p>
<p>cd ../..</p>
<p>rm -rf gcc-10.2.0</p>
<p>tar -xvf gettext-0.21.tar.xz</p>
<p>cd gettext-0.21</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/gettext.html">gettext-0.21</a></p>
<p>nice -n 1 make</p>
<p>cp -v gettext-tools/src/{msgfmt,msgmerge,xgettext} /usr/bin</p>
<p>cd ..</p>
<p>rm -rf gettext-0.21</p>
<p>tar -xvf bison-3.7.5.tar.xz</p>
<p>cd bison-3.7.5</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/bison.html">bison-3.7.5</a></p>
<p>cd ..</p>
<p>rm -rf bison-3.7.5</p>
<p>tar -xvf perl-5.32.1.tar.xz</p>
<p>cd perl-5.32.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/perl.html">perl-5.32.1</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf perl-5.32.1</p>
<p>tar -xvf Python-3.9.2.tar.xz</p>
<p>cd Python-3.9.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/Python.html">Python-3.9.2</a></p>
<blockquote>
<p>i use release here by <code>--enable-optimizations</code></p>
<pre><code>./configure --prefix=/usr   \
            --enable-shared \
            --without-ensurepip \
            --enable-optimizations
</code></pre></blockquote>
<p>nice -n 1 make</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf Python-3.9.2</p>
<p>tar -xvf texinfo-6.7.tar.xz</p>
<p>cd texinfo-6.7</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/texinfo.html">texinfo-6.7</a></p>
<p>cd ..</p>
<p>rm -rf texinfo-6.7</p>
<p>tar -xvf util-linux-2.36.2.tar.xz</p>
<p>cd util-linux-2.36.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/util-linux.html">util-linux-2.36.2</a></p>
<p>cd ..</p>
<p>rm -rf util-linux-2.36.2</p>
<p>now in chroot do:</p>
<pre><code>find /usr/{lib,libexec} -name \*.la -delete
</code></pre><pre><code>rm -rf /usr/share/{info,man,doc}/*
</code></pre><pre><code>exit	# to back to root user
</code></pre><p>after back to root user, do:</p>
<pre><code>umount $LFS/dev{/pts,}
umount $LFS/{sys,proc,run}
</code></pre><pre><code>strip --strip-debug $LFS/usr/lib/*
strip --strip-unneeded $LFS/usr/{,s}bin/*
strip --strip-unneeded $LFS/tools/bin/*
</code></pre><blockquote>
<pre><code>df -h	#to check
</code></pre></blockquote>
<p>Make sure $LFS has at least 600 MB free disk space (the source tarballs will be included in the backup archive) in the home directory of user <code>root</code>.</p>
<p>mount backup disk first:</p>
<pre><code>$# mkdir -pv /mnt/lfsbackup	#make /mnt/lfsbackup folder
$# mount -v -t ext4 /dev/sda4 /mnt/lfsbackup	#mount sda4 to /mnt/lfsbackup
</code></pre><p>create backup:</p>
<pre><code>cd $LFS &amp;&amp;
tar -cJpf /mnt/lfsbackup/lfs-temp-tools-10.0.tar.xz .
</code></pre><blockquote>
<p>i use this for backup:</p>
<pre><code>cd $LFS &amp;&amp;
tar cp . | xz -zveT4 &gt; /mnt/lfsbackup/lfs-temp-tools-10.0.tar.xz
</code></pre></blockquote>
<p>after backup, remount LFS virtual kernel file system and re-enter chroot:</p>
<pre><code>mount -v --bind /dev $LFS/dev
</code></pre><pre><code>mount -v --bind /dev/pts $LFS/dev/pts
mount -vt proc proc $LFS/proc
mount -vt sysfs sysfs $LFS/sys
mount -vt tmpfs tmpfs $LFS/run
</code></pre><pre><code>if [ -h $LFS/dev/shm ]; then
  mkdir -pv $LFS/$(readlink $LFS/dev/shm)
fi
</code></pre><pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i   \
    HOME=/root                  \
    TERM=&quot;$TERM&quot;                \
    PS1='(lfs chroot) \u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login +h
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i  <br>
HOME=/root                 <br>
TERM=&quot;$TERM&rdquo;               <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '<br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login +h</p>
</blockquote>
<h2 id="5-building-the-lfs-system-5">5. Building the LFS System <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup><a hidden class="anchor" aria-hidden="true" href="#5-building-the-lfs-system-5">#</a></h2>
<h3 id="installing-basic-system-software">Installing Basic System Software<a hidden class="anchor" aria-hidden="true" href="#installing-basic-system-software">#</a></h3>
<p>first:</p>
<p>cd /sources</p>
<p>tar -xvf man-pages-5.10.tar.xz</p>
<p>cd man-pages-5.10</p>
<p>make install</p>
<p>cd ..</p>
<p>rm -rf man-pages-5.10</p>
<p>tar -xvf iana-etc-20210202.tar.gz</p>
<p>cd iana-etc-20210202</p>
<p>cp services protocols /etc</p>
<p>cd ..</p>
<p>rm -rf iana-etc-20210202</p>
<p>tar -xvf glibc-2.33.tar.xz</p>
<p>cd glibc-2.33</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/glibc.html">glibc-2.33</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>touch /etc/ld.so.conf</p>
<p>sed &lsquo;/test-installation/s@$(PERL)@echo not running@&rsquo; -i ../Makefile</p>
<p>nice -n 1 make install</p>
<p>cp -v ../nscd/nscd.conf /etc/nscd.conf
mkdir -pv /var/cache/nscd</p>
<p>mkdir -pv /usr/lib/locale
localedef -i POSIX -f UTF-8 C.UTF-8 2&gt; /dev/null || true
localedef -i cs_CZ -f UTF-8 cs_CZ.UTF-8
localedef -i de_DE -f ISO-8859-1 de_DE
localedef -i de_DE@euro -f ISO-8859-15 de_DE@euro
localedef -i de_DE -f UTF-8 de_DE.UTF-8
localedef -i el_GR -f ISO-8859-7 el_GR
localedef -i en_GB -f UTF-8 en_GB.UTF-8
localedef -i en_HK -f ISO-8859-1 en_HK
localedef -i en_PH -f ISO-8859-1 en_PH
localedef -i en_US -f ISO-8859-1 en_US
localedef -i en_US -f UTF-8 en_US.UTF-8
localedef -i es_MX -f ISO-8859-1 es_MX
localedef -i fa_IR -f UTF-8 fa_IR
localedef -i fr_FR -f ISO-8859-1 fr_FR
localedef -i fr_FR@euro -f ISO-8859-15 fr_FR@euro
localedef -i fr_FR -f UTF-8 fr_FR.UTF-8
localedef -i it_IT -f ISO-8859-1 it_IT
localedef -i it_IT -f UTF-8 it_IT.UTF-8
localedef -i ja_JP -f EUC-JP ja_JP
localedef -i ja_JP -f SHIFT_JIS ja_JP.SIJS 2&gt; /dev/null || true
localedef -i ja_JP -f UTF-8 ja_JP.UTF-8
localedef -i ru_RU -f KOI8-R ru_RU.KOI8-R
localedef -i ru_RU -f UTF-8 ru_RU.UTF-8
localedef -i tr_TR -f UTF-8 tr_TR.UTF-8
localedef -i zh_CN -f GB18030 zh_CN.GB18030
localedef -i zh_HK -f BIG5-HKSCS zh_HK.BIG5-HKSCS</p>
<blockquote>
<p>alt, do:</p>
<pre><code>make localedata/install-locales
</code></pre></blockquote>
<pre><code>cat &gt; /etc/nsswitch.conf &lt;&lt; &quot;EOF&quot;
# Begin /etc/nsswitch.conf

passwd: files
group: files
shadow: files

hosts: files dns
networks: files

protocols: files
services: files
ethers: files
rpc: files

# End /etc/nsswitch.conf
EOF
</code></pre><pre><code>tar -xf ../../tzdata2021a.tar.gz

ZONEINFO=/usr/share/zoneinfo
mkdir -pv $ZONEINFO/{posix,right}

for tz in etcetera southamerica northamerica europe africa antarctica  \
          asia australasia backward; do
    zic -L /dev/null   -d $ZONEINFO       ${tz}
    zic -L /dev/null   -d $ZONEINFO/posix ${tz}
    zic -L leapseconds -d $ZONEINFO/right ${tz}
done

cp -v zone.tab zone1970.tab iso3166.tab $ZONEINFO
zic -d $ZONEINFO -p America/New_York
unset ZONEINFO
</code></pre><pre><code>tzselect
</code></pre><pre><code>ln -sfv /usr/share/zoneinfo/&lt;xxx&gt; /etc/localtime
#change the &lt;xxx&gt; to the selected time zone
</code></pre><pre><code>cat &gt; /etc/ld.so.conf &lt;&lt; &quot;EOF&quot;
# Begin /etc/ld.so.conf
/usr/local/lib
/opt/lib

EOF
</code></pre><pre><code>cat &gt;&gt; /etc/ld.so.conf &lt;&lt; &quot;EOF&quot;
# Add an include directory
include /etc/ld.so.conf.d/*.conf

EOF
mkdir -pv /etc/ld.so.conf.d
</code></pre><p>cd ../..</p>
<p>rm -rf glibc-2.33</p>
<p>tar -xvf zlib-1.2.11.tar.xz</p>
<p>cd zlib-1.2.11</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/zlib.html">zlib-1.2.11</a></p>
<p>cd ..</p>
<p>rm -rf zlib-1.2.11</p>
<p>tar -xvf bzip2-1.0.8.tar.gz</p>
<p>cd bzip2-1.0.8</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/bzip2.html">bzip2-1.0.8</a></p>
<p>cd ..</p>
<p>rm -rf bzip2-1.0.8</p>
<p>tar -xvf xz-5.2.5.tar.xz</p>
<p>cd xz-5.2.5</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/xz.html">xz-5.2.5</a></p>
<p>cd ..</p>
<p>rm -rf xz-5.2.5</p>
<p>tar -xvf zstd-1.4.8.tar.gz</p>
<p>cd zstd-1.4.8</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/zstd.html">zstd-1.4.8</a></p>
<p>cd ..</p>
<p>rm -rf zstd-1.4.8</p>
<p>tar -xvf file-5.39.tar.gz</p>
<p>cd file-5.39</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/file.html">file-5.39</a></p>
<p>cd ..</p>
<p>rm -rf file-5.39</p>
<p>tar -xvf readline-8.1.tar.gz</p>
<p>cd readline-8.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/readline.html">readline-8.1</a></p>
<p>cd ..</p>
<p>rm -rf readline-8.1</p>
<p>tar -xvf m4-1.4.18.tar.xz</p>
<p>cd m4-1.4.18</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/m4.html">m4-1.4.18</a></p>
<p>cd ..</p>
<p>rm -rf m4-1.4.18</p>
<p>tar -xvf bc-3.3.0.tar.xz</p>
<p>cd bc-3.3.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/bc.html">bc-3.3.0</a></p>
<p>cd ..</p>
<p>rm -rf bc-3.3.0</p>
<p>tar -xvf flex-2.6.4.tar.gz</p>
<p>cd flex-2.6.4</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/flex.html">flex-2.6.4</a></p>
<p>cd ..</p>
<p>rm -rf flex-2.6.4</p>
<p>tar -xvf tcl8.6.11-src.tar.gz</p>
<p>cd tcl8.6.11</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/tcl.html">tcl8.6.11</a></p>
<p>cd ../..</p>
<p>rm -rf tcl8.6.11</p>
<p>tar -xvf expect5.45.4.tar.gz</p>
<p>cd expect5.45.4</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/expect.html">expect5.45.4</a></p>
<p>cd ..</p>
<p>rm -rf expect5.45.4</p>
<p>tar -xvf dejagnu-1.6.2.tar.gz</p>
<p>cd dejagnu-1.6.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/dejagnu.html">dejagnu-1.6.2</a></p>
<p>cd ..</p>
<p>rm -rf dejagnu-1.6.2</p>
<p>tar -xvf binutils-2.36.1.tar.xz</p>
<p>cd binutils-2.36.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/binutils.html">binutils-2.36.1</a></p>
<p>nice -n 1 make tooldir=/usr</p>
<p>nice -n 1 make -k check</p>
<blockquote>
<p>Four tests named “Run          property &hellip;” are known to fail.</p>
<p>(Currently, if you had check-DEJAGNU, check-am, check-recursive, check, check-ld or do-check error; they&rsquo;re all common error to test harness,  which can be ignored)</p>
<p>refer:</p>
<p><a href="http://lists.linuxfromscratch.org/pipermail/lfs-support/2014-October/047863.html">http://lists.linuxfromscratch.org/pipermail/lfs-support/2014-October/047863.html</a></p>
<p><a href="http://lists.linuxfromscratch.org/pipermail/lfs-support/2016-August/050264.html">http://lists.linuxfromscratch.org/pipermail/lfs-support/2016-August/050264.html</a></p>
</blockquote>
<p>nice -n 1 make tooldir=/usr install</p>
<p>rm -fv /usr/lib/lib{bfd,ctf,ctf-nobfd,opcodes}.a</p>
<p>cd ../..</p>
<p>rm -rf binutils-2.36.1</p>
<p>tar -xvf gmp-6.2.1.tar.xz</p>
<p>cd gmp-6.2.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gmp.html">gmp-6.2.1</a></p>
<p>cd ..</p>
<p>rm -rf gmp-6.2.1</p>
<p>tar -xvf mpfr-4.1.0.tar.xz</p>
<p>cd mpfr-4.1.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/mpfr.html">mpfr-4.1.0</a></p>
<p>cd ..</p>
<p>rm -rf mpfr-4.1.0</p>
<p>tar -xvf mpc-1.2.1.tar.gz</p>
<p>cd mpc-1.2.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/mpc.html">mpc-1.2.1</a></p>
<p>cd ..</p>
<p>rm -rf mpc-1.2.1</p>
<p>tar -xvf attr-2.4.48.tar.gz</p>
<p>cd attr-2.4.48</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/attr.html">attr-2.4.48</a></p>
<p>cd ..</p>
<p>rm -rf attr-2.4.48</p>
<p>tar -xvf acl-2.2.53.tar.gz</p>
<p>cd acl-2.2.53</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/acl.html">acl-2.2.53</a></p>
<p>cd ..</p>
<p>rm -rf acl-2.2.53</p>
<p>tar -xvf libcap-2.48.tar.xz</p>
<p>cd libcap-2.48</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/libcap.html">libcap-2.48</a></p>
<p>cd ..</p>
<p>rm -rf libcap-2.48</p>
<p>tar -xvf shadow-4.8.1.tar.xz</p>
<p>cd shadow-4.8.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/shadow.html">shadow-4.8.1</a></p>
<pre><code>pwconv
</code></pre><pre><code>grpconv
</code></pre><pre><code>sed -i 's/yes/no/' /etc/default/useradd
</code></pre><pre><code>passwd root
</code></pre><p>cd ..</p>
<p>rm -rf shadow-4.8.1</p>
<p>tar -xvf gcc-10.2.0.tar.xz</p>
<p>cd gcc-10.2.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gcc.html">gcc-10.2.0</a></p>
<p>nice -n 1 make -j1</p>
<p>ulimit -s 32768</p>
<p>chown -Rv tester .
su tester -c &ldquo;PATH=$PATH make -k check&rdquo;</p>
<p>../contrib/test_summary</p>
<p>nice -n 1 make install
rm -rf /usr/lib/gcc/$(gcc -dumpmachine)/10.2.0/include-fixed/bits/</p>
<p>chown -v -R root:root<br>
/usr/lib/gcc/*linux-gnu/10.2.0/include{,-fixed}</p>
<p>ln -sv ../usr/bin/cpp /lib</p>
<p>install -v -dm755 /usr/lib/bfd-plugins
ln -sfv ../../libexec/gcc/$(gcc -dumpmachine)/10.2.0/liblto_plugin.so<br>
/usr/lib/bfd-plugins/</p>
<p>echo &lsquo;int main(){}&rsquo; &gt; dummy.c
cc dummy.c -v -Wl,&ndash;verbose &amp;&gt; dummy.log
readelf -l a.out | grep &lsquo;: /lib&rsquo;</p>
<p>grep -o &lsquo;/usr/lib.*/crt[1in].*succeeded&rsquo; dummy.log</p>
<p>grep -B4 &lsquo;^ /usr/include&rsquo; dummy.log</p>
<p>grep &lsquo;SEARCH.*/usr/lib&rsquo; dummy.log |sed &rsquo;s|; |\n|g&rsquo;</p>
<p>grep &ldquo;/lib.*/libc.so.6 &quot; dummy.log</p>
<p>grep found dummy.log</p>
<p>rm -v dummy.c a.out dummy.log</p>
<p>mkdir -pv /usr/share/gdb/auto-load/usr/lib
mv -v /usr/lib/*gdb.py /usr/share/gdb/auto-load/usr/lib</p>
<p>cd ../..</p>
<p>rm -rf gcc-10.2.0</p>
<p>tar -xvf pkg-config-0.29.2.tar.gz</p>
<p>cd pkg-config-0.29.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/pkg-config.html">pkg-config-0.29.2</a></p>
<p>cd ..</p>
<p>rm -rf pkg-config-0.29.2</p>
<p>tar -xvf ncurses-6.2.tar.gz</p>
<p>cd ncurses-6.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/ncurses.html">ncurses-6.2</a></p>
<p>cd ..</p>
<p>rm -rf ncurses-6.2</p>
<p>tar -xvf sed-4.8.tar.xz</p>
<p>cd sed-4.8</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/sed.html">sed-4.8</a></p>
<p>cd ..</p>
<p>rm -rf sed-4.8</p>
<p>tar -xvf psmisc-23.4.tar.xz</p>
<p>cd psmisc-23.4</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/psmisc.html">psmisc-23.4</a></p>
<p>cd ..</p>
<p>rm -rf psmisc-23.4</p>
<p>tar -xvf gettext-0.21.tar.xz</p>
<p>cd gettext-0.21</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gettext.html">gettext-0.21</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make install</p>
<p>chmod -v 0755 /usr/lib/preloadable_libintl.so</p>
<p>cd ..</p>
<p>rm -rf gettext-0.21</p>
<p>tar -xvf bison-3.7.5.tar.xz</p>
<p>cd bison-3.7.5</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/bison.html">bison-3.7.5</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf bison-3.7.5</p>
<p>tar -xvf grep-3.6.tar.xz</p>
<p>cd grep-3.6</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/grep.html">grep-3.6</a></p>
<p>cd ..</p>
<p>rm -rf grep-3.6</p>
<p>tar -xvf bash-5.1.tar.gz</p>
<p>cd bash-5.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/bash.html">bash-5.1</a></p>
<p>nice -n 1 make</p>
<p>chown -Rv tester .</p>
<p>su tester &laquo; EOF
PATH=$PATH make tests &lt; $(tty)
EOF</p>
<p>nice -n 1 make install
mv -vf /usr/bin/bash /bin</p>
<p>exec /bin/bash &ndash;login +h</p>
<p>cd ..</p>
<p>rm -rf bash-5.1</p>
<p>tar -xvf libtool-2.4.6.tar.xz</p>
<p>cd libtool-2.4.6</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/libtool.html">libtool-2.4.6</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make install</p>
<p>rm -fv /usr/lib/libltdl.a</p>
<p>cd ..</p>
<p>rm -rf libtool-2.4.6</p>
<p>tar -xvf gdbm-1.19.tar.gz</p>
<p>cd gdbm-1.19</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gdbm.html">gdbm-1.19</a></p>
<p>cd ..</p>
<p>rm -rf gdbm-1.19</p>
<p>tar -xvf gperf-3.1.tar.gz</p>
<p>cd gperf-3.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gperf.html">gperf-3.1</a></p>
<p>cd ..</p>
<p>rm -rf gperf-3.1</p>
<p>tar -xvf expat-2.2.10.tar.xz</p>
<p>cd expat-2.2.10</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/expat.html">expat-2.2.10</a></p>
<p>cd ..</p>
<p>rm -rf expat-2.2.10</p>
<p>tar -xvf inetutils-2.0.tar.xz</p>
<p>cd inetutils-2.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/inetutils.html">inetutils-2.0</a></p>
<p>cd ..</p>
<p>rm -rf inetutils-2.0</p>
<p>tar -xvf perl-5.32.1.tar.xz</p>
<p>cd perl-5.32.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/perl.html">perl-5.32.1</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make test</p>
<p>nice -n 1 make install
unset BUILD_ZLIB BUILD_BZIP2</p>
<p>cd ..</p>
<p>rm -rf perl-5.32.1</p>
<p>tar -xvf XML-Parser-2.46.tar.gz</p>
<p>cd XML-Parser-2.46</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/xml-parser.html">XML-Parser-2.46</a></p>
<p>cd ..</p>
<p>rm -rf XML-Parser-2.46</p>
<p>tar -xvf intltool-0.51.0.tar.gz</p>
<p>cd intltool-0.51.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/intltool.html">intltool-0.51.0</a></p>
<p>cd ..</p>
<p>rm -rf intltool-0.51.0</p>
<p>tar -xvf autoconf-2.71.tar.xz</p>
<p>cd autoconf-2.71</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/autoconf.html">autoconf-2.71</a></p>
<pre><code>make check	# currently broken by bash-5 and libtool-2.4.3
</code></pre><p>make install</p>
<p>cd ..</p>
<p>rm -rf autoconf-2.71</p>
<p>tar -xvf automake-1.16.3.tar.xz</p>
<p>cd automake-1.16.3</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/automake.html">automake-1.16.3</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make -j4 check</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf automake-1.16.3</p>
<p>tar -xvf kmod-28.tar.xz</p>
<p>cd kmod-28</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/kmod.html">kmod-28</a></p>
<p>cd ..</p>
<p>rm -rf kmod-28</p>
<p>tar -xvf elfutils-0.183.tar.bz2</p>
<p>cd elfutils-0.183</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/libelf.html">elfutils-0.183</a></p>
<p>cd ..</p>
<p>rm -rf elfutils-0.183</p>
<p>tar -xvf libffi-3.3.tar.gz</p>
<p>cd libffi-3.3</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/libffi.html">libffi-3.3</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf libffi-3.3</p>
<p>tar -xvf openssl-1.1.1j.tar.gz</p>
<p>cd openssl-1.1.1j</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/openssl.html">openssl-1.1.1j</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make test</p>
<p>One test 30-test_afalg.t is known to fail on some kernel configurations (it apparently assumes certain unspecified crypto          options have been selected).</p>
<p>sed -i &lsquo;/INSTALL_LIBS/s/libcrypto.a libssl.a//&rsquo; Makefile
nice -n 1 make MANSUFFIX=ssl install</p>
<p>mv -v /usr/share/doc/openssl /usr/share/doc/openssl-1.1.1j
cp -vfr doc/* /usr/share/doc/openssl-1.1.1j</p>
<p>cd ..</p>
<p>rm -rf openssl-1.1.1j</p>
<p>tar -xvf Python-3.9.2.tar.xz</p>
<p>cd Python-3.9.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/Python.html">Python-3.9.2</a></p>
<blockquote>
<p>i use release here by <code>--enable-optimizations</code></p>
<pre><code>./configure --prefix=/usr        \
            --enable-shared      \
            --with-system-expat  \
            --with-system-ffi    \
            --with-ensurepip=yes \
            --enable-optimizations
</code></pre></blockquote>
<p>nice -n 1 make</p>
<p>nice -n 1 make install</p>
<p>install -v -dm755 /usr/share/doc/python-3.9.2/html</p>
<p>tar &ndash;strip-components=1 <br>
&ndash;no-same-owner      <br>
&ndash;no-same-permissions<br>
-C /usr/share/doc/python-3.9.2/html<br>
-xvf ../python-3.9.2-docs-html.tar.bz2</p>
<p>cd ..</p>
<p>rm -rf Python-3.9.2</p>
<p>tar -xvf ninja-1.10.2.tar.gz</p>
<p>cd ninja-1.10.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/ninja.html">ninja-1.10.2</a></p>
<p>cd ..</p>
<p>rm -rf ninja-1.10.2</p>
<p>tar -xvf meson-0.57.1.tar.gz</p>
<p>cd meson-0.57.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/meson.html">meson-0.57.1</a></p>
<p>cd ..</p>
<p>rm -rf meson-0.57.1</p>
<p>tar -xvf coreutils-8.32.tar.xz</p>
<p>cd coreutils-8.32</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/coreutils.html">coreutils-8.32</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make NON_ROOT_USERNAME=tester check-root</p>
<p>echo &ldquo;dummy:x:102:tester&rdquo; &raquo; /etc/group</p>
<p>chown -Rv tester .</p>
<p>su tester -c &ldquo;PATH=$PATH make RUN_EXPENSIVE_TESTS=yes check&rdquo;</p>
<p>The test-getlogin test is known to fail in the LFS chroot          environment.</p>
<p>sed -i &lsquo;/dummy/d&rsquo; /etc/group</p>
<p>nice -n 1 make install</p>
<p>mv -v /usr/bin/{cat,chgrp,chmod,chown,cp,date,dd,df,echo} /bin
mv -v /usr/bin/{false,ln,ls,mkdir,mknod,mv,pwd,rm} /bin
mv -v /usr/bin/{rmdir,stty,sync,true,uname} /bin
mv -v /usr/bin/chroot /usr/sbin
mv -v /usr/share/man/man1/chroot.1 /usr/share/man/man8/chroot.8
sed -i &rsquo;s/&ldquo;1&rdquo;/&ldquo;8&rdquo;/&rsquo; /usr/share/man/man8/chroot.8</p>
<p>mv -v /usr/bin/{head,nice,sleep,touch} /bin</p>
<p>cd ..</p>
<p>rm -rf coreutils-8.32</p>
<p>tar -xvf check-0.15.2.tar.gz</p>
<p>cd check-0.15.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/check.html">check-0.15.2</a></p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make docdir=/usr/share/doc/check-0.15.2 install</p>
<p>cd ..</p>
<p>rm -rf check-0.15.2</p>
<p>tar -xvf diffutils-3.7.tar.xz</p>
<p>cd diffutils-3.7</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/diffutils.html">diffutils-3.7</a></p>
<p>cd ..</p>
<p>rm -rf diffutils-3.7</p>
<p>tar -xvf gawk-5.1.0.tar.xz</p>
<p>cd gawk-5.1.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gawk.html">gawk-5.1.0</a></p>
<p>cd ..</p>
<p>rm -rf gawk-5.1.0</p>
<p>tar -xvf findutils-4.8.0.tar.xz</p>
<p>cd findutils-4.8.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/findutils.html">findutils-4.8.0</a></p>
<p>cd ..</p>
<p>rm -rf findutils-4.8.0</p>
<p>tar -xvf groff-1.22.4.tar.gz</p>
<p>cd groff-1.22.4</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/groff.html">groff-1.22.4</a></p>
<p>Choose either one:</p>
<pre><code>PAGE=letter ./configure --prefix=/usr	#For users in the United States

PAGE=A4 ./configure --prefix=/usr	#Elsewhere
</code></pre><p>make -j1</p>
<p>make install</p>
<p>cd ..</p>
<p>rm -rf groff-1.22.4</p>
<p>tar -xvf grub-2.04.tar.xz</p>
<p>cd grub-2.04</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/grub.html">grub-2.04</a></p>
<p>cd ..</p>
<p>rm -rf grub-2.04</p>
<p>tar -xvf less-563.tar.gz</p>
<p>cd less-563</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/less.html">less-563</a></p>
<p>cd ..</p>
<p>rm -rf less-563</p>
<p>tar -xvf gzip-1.10.tar.xz</p>
<p>cd gzip-1.10</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/gzip.html">gzip-1.10</a></p>
<p>cd ..</p>
<p>rm -rf gzip-1.10</p>
<p>tar -xvf iproute2-5.10.0.tar.xz</p>
<p>cd iproute2-5.10.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/iproute2.html">iproute2-5.10.0</a></p>
<p>cd ..</p>
<p>rm -rf iproute2-5.10.0</p>
<p>tar -xvf kbd-2.4.0.tar.xz</p>
<p>cd kbd-2.4.0</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/kbd.html">kbd-2.4.0</a></p>
<p>cd ..</p>
<p>rm -rf kbd-2.4.0</p>
<p>tar -xvf libpipeline-1.5.3.tar.gz</p>
<p>cd libpipeline-1.5.3</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/libpipeline.html">libpipeline-1.5.3</a></p>
<p>cd ..</p>
<p>rm -rf libpipeline-1.5.3</p>
<p>tar -xvf make-4.3.tar.gz</p>
<p>cd make-4.3</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/make.html">make-4.3</a></p>
<p>cd ..</p>
<p>rm -rf make-4.3</p>
<p>tar -xvf patch-2.7.6.tar.xz</p>
<p>cd patch-2.7.6</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/patch.html">patch-2.7.6</a></p>
<p>cd ..</p>
<p>rm -rf patch-2.7.6</p>
<p>tar -xvf man-db-2.9.4.tar.xz</p>
<p>cd man-db-2.9.4</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/man-db.html">man-db-2.9.4</a></p>
<p>cd ..</p>
<p>rm -rf man-db-2.9.4</p>
<p>tar -xvf tar-1.34.tar.xz</p>
<p>cd tar-1.34</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/tar.html">tar-1.34</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<blockquote>
<p>One test, capabilities: binary store/restore, is known to fail.</p>
</blockquote>
<p>nice -n 1 make install
nice -n 1 make -C doc install-html docdir=/usr/share/doc/tar-1.34</p>
<p>cd ..</p>
<p>rm -rf tar-1.34</p>
<p>tar -xvf texinfo-6.7.tar.xz</p>
<p>cd texinfo-6.7</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/texinfo.html">texinfo-6.7</a></p>
<p>cd ..</p>
<p>rm -rf texinfo-6.7</p>
<blockquote>
<p>now to install Editor</p>
<p>I use vim, btw</p>
</blockquote>
<p>tar -xvf vim-8.2.2433.tar.gz</p>
<p>cd vim-8.2.2433</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/vim.html">vim-8.2.2433</a></p>
<p>nice -n 1 make</p>
<p>chown -Rv tester .</p>
<p>su tester -c &ldquo;LANG=en_US.UTF-8 make -j1 test&rdquo; &amp;&gt; vim-test.log</p>
<p>nice -n 1 make install</p>
<p>Many users are used to using <strong>vi</strong> instead of <strong>vim</strong>. To allow execution of <strong>vim</strong> when users habitually enter <strong>vi</strong>, create a symlink for both the binary and the man page in the provided languages:</p>
<pre><code>ln -sv vim /usr/bin/vi
for L in  /usr/share/man/{,*/}man1/vim.1; do
    ln -sv vim.1 $(dirname $L)/vi.1
done
</code></pre><p>ln -sv ../vim/vim82/doc /usr/share/doc/vim-8.2.2433</p>
<p>Configuring Vim:</p>
<pre><code>cat &gt; /etc/vimrc &lt;&lt; &quot;EOF&quot;
&quot; Begin /etc/vimrc

&quot; Ensure defaults are set before customizing settings, not after
source $VIMRUNTIME/defaults.vim
let skip_defaults_vim=1 

set nocompatible
set backspace=2
set mouse=
syntax on
if (&amp;term == &quot;xterm&quot;) || (&amp;term == &quot;putty&quot;)
  set background=dark
endif

&quot; End /etc/vimrc
EOF
</code></pre><blockquote>
<p>Documentation for other available options can be obtained by          running the following command:</p>
<pre><code>vim -c ':options'
</code></pre><p>By default, vim only installs spell files for the English language. To install spell files for your preferred language,            download the <code>*.spl</code> and optionally, the <code>*.sug</code> files for your language and character encoding from <a href="ftp://ftp.vim.org/pub/vim/runtime/spell/">ftp://ftp.vim.org/pub/vim/runtime/spell/</a> and save them to <code>/usr/share/vim/vim82/spell/</code>.</p>
<p>To use these spell files, some configuration in <code>/etc/vimrc</code> is needed, e.g.:</p>
<pre><code>set spelllang=en,ru
set spell
</code></pre><p>For more information, see the appropriate README file located at the URL above.</p>
</blockquote>
<p>cd ..</p>
<p>rm -rf vim-8.2.2433</p>
<p>tar -xvf eudev-3.2.10.tar.gz</p>
<p>cd eudev-3.2.10</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/eudev.html">eudev-3.2.10</a></p>
<p>cd ..</p>
<p>rm -rf eudev-3.2.10</p>
<p>tar -xvf procps-ng-3.3.17.tar.xz</p>
<p>cd procps-3.3.17</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/procps-ng.html">procps-ng-3.3.17</a></p>
<p>cd ..</p>
<p>rm -rf procps-3.3.17</p>
<p>tar -xvf util-linux-2.36.2.tar.xz</p>
<p>cd util-linux-2.36.2</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/util-linux.html">util-linux-2.36.2</a></p>
<p>nice -n 1 make</p>
<p>chown -Rv tester .
su tester -c &ldquo;make -k check&rdquo;</p>
<p>nice -n 1 make install</p>
<p>cd ..</p>
<p>rm -rf util-linux-2.36.2</p>
<p>tar -xvf e2fsprogs-1.46.1.tar.gz</p>
<p>cd e2fsprogs-1.46.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/e2fsprogs.html">e2fsprogs-1.46.1</a></p>
<p>nice -n 1 make</p>
<p>nice -n 1 make check</p>
<p>nice -n 1 make install</p>
<p>rm -fv /usr/lib/{libcom_err,libe2p,libext2fs,libss}.a</p>
<p>gunzip -v /usr/share/info/libext2fs.info.gz
install-info &ndash;dir-file=/usr/share/info/dir /usr/share/info/libext2fs.info</p>
<p>makeinfo -o      doc/com_err.info ../lib/et/com_err.texinfo
install -v -m644 doc/com_err.info /usr/share/info
install-info &ndash;dir-file=/usr/share/info/dir /usr/share/info/com_err.info</p>
<p>cd ../..</p>
<p>rm -rf e2fsprogs-1.46.1</p>
<p>tar -xvf sysklogd-1.5.1.tar.gz</p>
<p>cd sysklogd-1.5.1</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/sysklogd.html">sysklogd-1.5.1</a></p>
<p>cd ..</p>
<p>rm -rf sysklogd-1.5.1</p>
<p>tar -xvf sysvinit-2.98.tar.xz</p>
<p>cd sysvinit-2.98</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/sysvinit.html">sysvinit-2.98</a></p>
<p>cd ..</p>
<p>rm -rf sysvinit-2.98</p>
<p>ALL BASIC SYSTEM SOFTWARE DONE</p>
<blockquote>
<pre><code>df -h	# check disk usage
</code></pre></blockquote>
<p>Now <strong>stripping again</strong> to remove the debugging symbols from binaries and libraries (optional, but recommend for saving disk space):</p>
<pre><code>save_lib=&quot;ld-2.32.so libc-2.32.so libpthread-2.32.so libthread_db-1.0.so&quot;

cd /lib

for LIB in $save_lib; do
    objcopy --only-keep-debug $LIB $LIB.dbg 
    strip --strip-unneeded $LIB
    objcopy --add-gnu-debuglink=$LIB.dbg $LIB 
done    

save_usrlib=&quot;libquadmath.so.0.0.0 libstdc++.so.6.0.28
             libitm.so.1.0.0 libatomic.so.1.2.0&quot; 

cd /usr/lib

for LIB in $save_usrlib; do
    objcopy --only-keep-debug $LIB $LIB.dbg
    strip --strip-unneeded $LIB
    objcopy --add-gnu-debuglink=$LIB.dbg $LIB
done

unset LIB save_lib save_usrlib
</code></pre><pre><code>find /usr/lib -type f -name \*.a \
   -exec strip --strip-debug {} ';'
</code></pre><pre><code>find /lib /usr/lib -type f -name \*.so* ! -name \*dbg \
   -exec strip --strip-unneeded {} ';'
</code></pre><pre><code>find /{bin,sbin} /usr/{bin,sbin,libexec} -type f \
    -exec strip --strip-all {} ';'
</code></pre><p>A large number of files will be reported as having their file format        not recognized. These warnings can be safely ignored. These warnings indicate that those files are scripts instead of binaries.</p>
<blockquote>
<pre><code>df -h	# check disk usage
</code></pre></blockquote>
<p>After above tasks done, cleaning up temp and extra files:</p>
<pre><code>rm -rf /tmp/*
</code></pre><p>Now log out and reenter the chroot environment with an updated chroot command. From now on, use this updated chroot command any time you need to reenter the chroot environment after exiting:</p>
<pre><code>logout
</code></pre><pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i          \
    HOME=/root TERM=&quot;$TERM&quot;            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i         <br>
HOME=/root TERM=&quot;$TERM&rdquo;           <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '       <br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login</p>
</blockquote>
<p>Here the <em><code>+h</code></em> option is not used anymore, since all the previous programs have been replaced: hashing is therefore possible.</p>
<p>If the virtual kernel file systems have been unmounted, either        manually or through a reboot, ensure that the virtual kernel file        systems are mounted when reentering the chroot. This process was        explained in <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/kernfs.html#ch-tools-bindmount">Section 7.3.2, “Mounting and Populating /dev”</a> and <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/kernfs.html#ch-tools-kernfsmount">Section 7.3.3, “Mounting Virtual Kernel File Systems”</a>.</p>
<p>There were several static libraries that were not suppressed earlier        in the chapter in order to satisfy the regression tests in several        packages. These libraries are from binutils, bzip2, e2fsprogs, flex,        libtool, and zlib. If desired, remove them now:</p>
<pre><code>rm -f /usr/lib/lib{bfd,opcodes}.a
rm -f /usr/lib/libctf{,-nobfd}.a
rm -f /usr/lib/libbz2.a
rm -f /usr/lib/lib{com_err,e2p,ext2fs,ss}.a
rm -f /usr/lib/libltdl.a
rm -f /usr/lib/libfl.a
rm -f /usr/lib/libz.a
</code></pre><p>There are also several files installed in the /usr/lib and /usr/libexec directories with a file name extension of .la. These are &ldquo;libtool archive&rdquo; files. As already said, they are only useful whe linking with static libraries. They are unneeded, and potentially harmful, when using dynamic shared libraries, specially when using also non-autotools build systems. To remove them, run:</p>
<pre><code>find /usr/lib /usr/libexec -name \*.la -delete
</code></pre><p>For more information about libtool archive files, see the <a href="http://www.linuxfromscratch.org/blfs/view/10.0//introduction/la-files.html">BLFS section &ldquo;About Libtool Archive (.la) files&rdquo;</a>.</p>
<p>The compiler built in <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter06/chapter06.html">Chapter 6</a> and <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter07/chapter07.html">Chapter 7</a> is still partially installed and not needed anymore. Remove it with:</p>
<pre><code>find /usr -depth -name $(uname -m)-lfs-linux-gnu\* | xargs rm -rf
</code></pre><p>The <code>/tools</code> directory can also be removed to further gain some place:</p>
<pre><code>rm -rf /tools
</code></pre><p>Finally, remove the temporary &lsquo;tester&rsquo; user account created at the        beginning of the previous chapter.</p>
<pre><code>userdel -r tester
</code></pre><h3 id="system-configuration">System Configuration<a hidden class="anchor" aria-hidden="true" href="#system-configuration">#</a></h3>
<p>make sure $LFS exported:</p>
<pre><code>echo $LFS
export LFS=/mnt/lfs
</code></pre><h4 id="install-lfs-bootscripts">Install LFS Bootscripts<a hidden class="anchor" aria-hidden="true" href="#install-lfs-bootscripts">#</a></h4>
<p>in chroot:</p>
<pre><code>cd /sources
</code></pre><p>tar -xvf lfs-bootscripts-20210201.tar.xz</p>
<p>cd lfs-bootscripts-20210201</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/bootscripts.html">lfs-bootscripts-20210201</a></p>
<p>cd ..</p>
<p>rm -rf lfs-bootscripts-20210201</p>
<h4 id="managing-devices-optionalhttpwwwlinuxfromscratchorglfsviewstablechapter09symlinkshtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/symlinks.html">Managing Devices (optional)</a><a hidden class="anchor" aria-hidden="true" href="#managing-devices-optionalhttpwwwlinuxfromscratchorglfsviewstablechapter09symlinkshtml">#</a></h4>
<h4 id="general-network-configuration">General Network Configuration<a hidden class="anchor" aria-hidden="true" href="#general-network-configuration">#</a></h4>
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html</a></p>
<p>go back to host root user (unchroot)</p>
<p>with:</p>
<pre><code>exit 
</code></pre><p>then do:</p>
<pre><code>ip a
</code></pre><p>to check your network interfaces</p>
<p>example output:</p>
<pre><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3
       valid_lft 73775sec preferred_lft 73775sec
    inet6 ::1/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
</code></pre><blockquote>
<p>The interface name of Ethernet, should be <code>enpXsX</code> or <code>ethX</code></p>
</blockquote>
<p>To example, the Ethernet interface name is <code>enp0s3</code></p>
<blockquote>
<p>In <a href="https://www.youtube.com/channel/UCFajCKBeNRW16Xb5mJvrCvw">Kernotex</a>&rsquo;s Tutorial, because of using Gentoo LiveCD, he can copy the network config to LFS</p>
<p>In Arch, because of KISS, it should use netctl (not installed) to edit the network config</p>
</blockquote>
<p>enter to chroot:</p>
<pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i          \
    HOME=/root TERM=&quot;$TERM&quot;            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i         <br>
HOME=/root TERM=&quot;$TERM&rdquo;           <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '       <br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login</p>
</blockquote>
<p>then follow descriptions of chapter <code>9.5.1. Creating Network Interface Configuration Files</code> in the link:</p>
<p><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter09/network.html</a></p>
<blockquote>
<p>To the example, do:</p>
<pre><code>cd /etc/sysconfig/
cat &gt; ifconfig.enp0s3 &lt;&lt; &quot;EOF&quot;
ONBOOT=yes
IFACE=enp0s3
SERVICE=ipv4-static
IP=10.0.2.15
GATEWAY=10.0.2.1
PREFIX=24
BROADCAST=10.0.2.255
EOF
</code></pre><blockquote>
<p>DHCP is addressed in the BLFS book, so using <code>ipv4-static</code> first before DHCP configurations</p>
</blockquote>
</blockquote>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre><p>then do:</p>
<pre><code>cp /etc/resolv.conf $LFS/etc
</code></pre><p>before copy the host&rsquo;s hostname to LFS, the former should be set</p>
<p>to set it, add /etc/hostname to include a single line with <code>myhostname</code>:</p>
<pre><code>echo &quot;myhostname&quot; &gt; /etc/hostname
</code></pre><p>then copy it to LFS:</p>
<pre><code>cp /etc/hostname $LFS/etc
</code></pre><p>copy the host&rsquo;s <strong>hosts</strong> file to LFS:</p>
<pre><code>cp /etc/hosts $LFS/etc
</code></pre><h4 id="system-configurationhttpwwwlinuxfromscratchorglfsviewstablechapter09usagehtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/usage.html">System Configuration</a><a hidden class="anchor" aria-hidden="true" href="#system-configurationhttpwwwlinuxfromscratchorglfsviewstablechapter09usagehtml">#</a></h4>
<p>chroot first:</p>
<pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i          \
    HOME=/root TERM=&quot;$TERM&quot;            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i         <br>
HOME=/root TERM=&quot;$TERM&rdquo;           <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '       <br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login</p>
</blockquote>
<h4 id="the-bash-shell-startup-files">The Bash Shell Startup Files<a hidden class="anchor" aria-hidden="true" href="#the-bash-shell-startup-files">#</a></h4>
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/profile.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter09/profile.html</a></p>
<p>first list available languages by doing:</p>
<pre><code>locale -a
</code></pre><blockquote>
<p>I use:</p>
<p>en_US.utf8</p>
</blockquote>
<p>Charmaps can have a number of aliases, e.g., “ISO-8859-1” is also referred to as “iso8859-1” and “iso88591”. Some applications cannot handle the various synonyms correctly (e.g., require that “UTF-8” is written as “UTF-8”, not “utf8”), so it is safest in most cases to choose the canonical name for a particular locale. To determine the canonical name, run the following command, where <em><code>&lt;locale name&gt;</code></em> is the output given by <strong>locale -a</strong> for your preferred locale (“en_GB.iso88591” in our example).</p>
<pre><code>LC_ALL=&lt;locale name&gt; locale charmap
</code></pre><p>For the “en_GB.iso88591” locale, the above command will print:</p>
<pre><code>ISO-8859-1
</code></pre><p>This results in a final locale setting of “en_GB.ISO-8859-1”. It is important that the locale found using the heuristic above is tested prior to it being added to the Bash startup files:</p>
<pre><code>LC_ALL=&lt;locale name&gt; locale language
LC_ALL=&lt;locale name&gt; locale charmap
LC_ALL=&lt;locale name&gt; locale int_curr_symbol
LC_ALL=&lt;locale name&gt; locale int_prefix
</code></pre><p>The above commands should print the language name, the character encoding used by the locale, the local currency, and the prefix to dial before the telephone number in order to get into the country. If any of the commands above fail with a message similar to the one shown below, this means that your locale was either not installed in <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter08/glibc.html">Section 8.8, “Glibc-2.32”</a> or is not supported by the default installation of Glibc.</p>
<pre><code>locale: Cannot set LC_* to default locale: No such file or directory
</code></pre><p>If this happens, you should either install the desired locale using        the <strong>localedef</strong> command, or consider choosing a different locale. Further instructions assume that there are no such error messages from Glibc.</p>
<p>Other packages can also function incorrectly (but may not necessarily display any error messages) if the locale name does not meet their expectations. In those cases, investigating how other Linux distributions support your locale might provide some useful information.</p>
<p>Once the proper locale settings have been determined, create the <code>/etc/profile</code> file:</p>
<pre><code>cat &gt; /etc/profile &lt;&lt; &quot;EOF&quot;
# Begin /etc/profile

export LANG=&lt;ll&gt;_&lt;CC&gt;.&lt;charmap&gt;&lt;@modifiers&gt;

# End /etc/profile
EOF
</code></pre><blockquote>
<p>I use:</p>
<p>en_US.utf8</p>
<pre><code>cat &gt; /etc/profile &lt;&lt; &quot;EOF&quot;
# Begin /etc/profile

export LANG=en_US.UTF-8

# End /etc/profile
EOF
</code></pre></blockquote>
<pre><code>cat /etc/profile	＃ to check
</code></pre><h4 id="creating-the-etcinputrc-file">Creating the /etc/inputrc File<a hidden class="anchor" aria-hidden="true" href="#creating-the-etcinputrc-file">#</a></h4>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre><p>then, in host, copy /etc/inputrc to LFS:</p>
<pre><code>cp /etc/inputrc $LFS/etc
</code></pre><blockquote>
<p>or follow the refer to make the file:</p>
<p><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/inputrc.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter09/inputrc.html</a></p>
</blockquote>
<h4 id="creating-the-etcshells-file">Creating the /etc/shells File<a hidden class="anchor" aria-hidden="true" href="#creating-the-etcshells-file">#</a></h4>
<blockquote>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre></blockquote>
<p>then, in host, copy /etc/shells to LFS:</p>
<pre><code>cp /etc/shells $LFS/etc
</code></pre><blockquote>
<p>or follow the refer to make the file:</p>
<p><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter09/etcshells.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter09/etcshells.html</a></p>
</blockquote>
<h3 id="making-the-lfs-system-bootable">Making the LFS System Bootable<a hidden class="anchor" aria-hidden="true" href="#making-the-lfs-system-bootable">#</a></h3>
<h4 id="creating-the-etcfstab-filehttpwwwlinuxfromscratchorglfsviewstablechapter10fstabhtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/fstab.html">Creating the /etc/fstab File</a><a hidden class="anchor" aria-hidden="true" href="#creating-the-etcfstab-filehttpwwwlinuxfromscratchorglfsviewstablechapter10fstabhtml">#</a></h4>
<blockquote>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre></blockquote>
<p>then, in host</p>
<p>copy /etc/fstab to LFS:</p>
<pre><code>cp /etc/fstab $LFS/etc
</code></pre><blockquote>
<p>or follow the refer to make the file:</p>
<p><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/fstab.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter10/fstab.html</a></p>
</blockquote>
<p>copy i915 firmware loader to LFS:</p>
<pre><code>cp -avx /lib/firmware/i915/ $LFS/lib/firmware/
cp -avx /lib64/firmware/i915/ $LFS/lib64/firmware/
</code></pre><p>now, view the file to double check there should be no changes:</p>
<p>by vim:</p>
<pre><code>vim $LFS/etc/fstab
</code></pre><blockquote>
<p>for me</p>
<p>the host&rsquo;s /etc/fstab like this:</p>
<pre><code># /etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;
# / was on /dev/sda3 during curtin installation
/dev/disk/by-uuid/XXXX-XXXX-XXXX-XXXX-XXXX / ext4 defaults 0 0
# /boot was on /dev/sda2 during curtin installation
/dev/disk/by-uuid/XXXX-XXXX-XXXX-XXXX-XXXX /boot ext4 defaults 0 0
# /boot/efi was on /dev/sda1 during curtin installation
/dev/disk/by-uuid/XXXX-XXXX /boot/efi vfat defaults 0 0

/dev/sda4 /mnt/lfs ext4 defaults 1 1

none /dev/pts devpts defaults 0 0
</code></pre><p>if done, then <code>:q</code></p>
</blockquote>
<h4 id="the-kernel---linux-51017httpwwwlinuxfromscratchorglfsviewstablechapter10kernelhtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/kernel.html">The kernel - Linux-5.10.17</a><a hidden class="anchor" aria-hidden="true" href="#the-kernel---linux-51017httpwwwlinuxfromscratchorglfsviewstablechapter10kernelhtml">#</a></h4>
<blockquote>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre></blockquote>
<p>before chroot, copy the host&rsquo;s <code>config-X.X.X-XX-generic</code> to $LFS/sources folder: (for Ubuntu)</p>
<pre><code>cp /boot/config-X.X.X-XX-generic $LFS/sources/.config
</code></pre><blockquote>
<p>for Arch Linux:</p>
<p>extract the host&rsquo;s current kernel settings as <code>.config</code> to $LFS/sources folder:</p>
<pre><code>zcat /proc/config.gz &gt; $LFS/sources/.config
</code></pre><p>if the host use other distros, please search about the host distro&rsquo;s .config, then copy it to $LFS/sources</p>
</blockquote>
<p>then chroot:</p>
<pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i          \
    HOME=/root TERM=&quot;$TERM&quot;            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i         <br>
HOME=/root TERM=&quot;$TERM&rdquo;           <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '       <br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login</p>
</blockquote>
<p>change directory to /sources:</p>
<pre><code>cd /sources
</code></pre><p>now, do:</p>
<p>nice -n 1 tar -Jxvf linux-5.10.17.tar.xz</p>
<p>cd linux-5.10.17</p>
<p>goo <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/kernel.html">linux-5.10.17</a></p>
<p>make mrproper</p>
<p>cp ../.config .</p>
<p>make oldconfig</p>
<blockquote>
<p>if you don&rsquo;t know how to choose options, just use defaults (uppercase)</p>
</blockquote>
<p>make menuconfig</p>
<blockquote>
<p>please checking with <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/kernel.html">the doc</a> or <a href="https://youtu.be/nK5iRqchX3U?t=361">Kernotex&rsquo;s video</a> to make sure kernel configurations are correctly set</p>
</blockquote>
<blockquote>
<p>if <code>→ Device Drivers → Generic Driver Options → Firmware loader → Build named firmware blobs into the kernel binary</code> setting is blank, input:</p>
<pre><code>i915/kbl_dmc_ver1_04.bin
</code></pre></blockquote>
<blockquote>
<p>For me, i recommend use Gzip (which already installed in LFS) to do kernel compression</p>
<p>General setup &ndash;&gt; Kernel compression mode (<strong>Gzip</strong>)  &mdash;&gt;</p>
</blockquote>
<p>nice -n 1 make</p>
<blockquote>
<p>it may take much long time, be patient.</p>
</blockquote>
<blockquote>
<p>If it shows <code>make[1]: *** [kernel/Makefile:144: kernel/kheaders_data.tar.xz] Error 127</code> or similar errors</p>
<p>disable CONFIG_IKHEADERS by:</p>
<p>search and edit the line in .config file</p>
<pre><code>CONFIG_IKHEADERS=m
</code></pre><p>to</p>
<pre><code># CONFIG_IKHEADERS is not set
</code></pre></blockquote>
<pre><code>BTF: .tmp_vmlinux.btf: pahole (pahole) is not available
Failed to generate BTF for vmlinux                                Try to disable CONFIG_DEBUG_INFO_BTF
make: *** [Makefile:1139: vmlinux] Error 1
make: Target '__all' not remade because of errors.
</code></pre><blockquote>
<p>if &lsquo;arch/x86/boot/bzImage&rsquo; missing, do:</p>
<pre><code>make bzImage
</code></pre></blockquote>
<p>nice -n 1 make modules_install</p>
<blockquote>
<p>If the host system has a separate /boot partition, the files copied below should go there. The easiest way to do that is to bind /boot on the host (outside chroot) to /mnt/lfs/boot before proceeding. As the root user in the <em>host system</em>:</p>
<pre><code>mount --bind /boot /mnt/lfs/boot
</code></pre></blockquote>
<p>cp -iv arch/x86/boot/bzImage /boot/vmlinuz-5.10.17-lfs-10.1</p>
<p>cp -iv System.map /boot/System.map-5.10.17</p>
<p>cp -iv .config /boot/config-5.10.17</p>
<p>install -d /usr/share/doc/linux-5.10.17
cp -r Documentation/* /usr/share/doc/linux-5.10.17</p>
<p>chown -R 0:0  ../linux-5.10.17</p>
<pre><code>install -v -m755 -d /etc/modprobe.d
cat &gt; /etc/modprobe.d/usb.conf &lt;&lt; &quot;EOF&quot;
# Begin /etc/modprobe.d/usb.conf

install ohci_hcd /sbin/modprobe ehci_hcd ; /sbin/modprobe -i ohci_hcd ; true
install uhci_hcd /sbin/modprobe ehci_hcd ; /sbin/modprobe -i uhci_hcd ; true

# End /etc/modprobe.d/usb.conf
EOF
</code></pre><p>rm ../.config</p>
<h4 id="using-grub-to-set-up-the-boot-process">Using GRUB to Set Up the Boot Process<a hidden class="anchor" aria-hidden="true" href="#using-grub-to-set-up-the-boot-process">#</a></h4>
<p>follow <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter10/grub.html">the doc</a> or <a href="https://youtu.be/nK5iRqchX3U?t=1039">Kernotex&rsquo;s video</a> to setup GRUB</p>
<blockquote>
<p>to copy the host&rsquo;s grub config to LFS:</p>
<p>go back to host root user (unchroot) again with:</p>
<pre><code>exit
</code></pre><p>then, in host, copy /boot/grub/grub.cfg to LFS:</p>
<pre><code>mkdir -p $LFS/boot/grub/ &amp;&amp; cp /boot/grub/grub.cfg $LFS/boot/grub/
</code></pre><p>then chroot:</p>
<pre><code>chroot &quot;$LFS&quot; /usr/bin/env -i          \
    HOME=/root TERM=&quot;$TERM&quot;            \
    PS1='(lfs chroot) \u:\w\$ '        \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /bin/bash --login
</code></pre><blockquote>
<p>I personly use:</p>
<p>chroot &ldquo;$LFS&rdquo; /usr/bin/env -i         <br>
HOME=/root TERM=&quot;$TERM&rdquo;           <br>
PS1=&rsquo;(lfs chroot) \u:\w$ '       <br>
PATH=/bin:/usr/bin:/sbin:/usr/sbin<br>
MAKEFLAGS=&rdquo;-j4 -l2&rdquo;<br>
/bin/bash &ndash;login</p>
</blockquote>
</blockquote>
<blockquote>
<p>Before installing GRUB as bootloader, it&rsquo;s recommend to backup</p>
<p>if you&rsquo;re using VM, you can use snapshot to record</p>
</blockquote>
<p><strong><a href="#ps2-install-grub-to-uefi">[UEFI] Install GRUB</a> (skip if GRUB already installed on host or you are using MBR, legacy BIOS, etc)</strong></p>
<p>installing GRUB bootloader into /dev/sda:</p>
<pre><code>grub-install /dev/sda
</code></pre><p>GRUB config examples:</p>
<pre><code>set default=0
set timeout=5

insmod ext2
set root=(hd0,2)

menuentry &quot;GNU/Linux, Linux 5.10.17-lfs-10.1&quot; {
        linux   /boot/vmlinuz-5.10.17-lfs-10.1 root=/dev/sda2 ro
}
</code></pre><p>for /etc/grub.d/40_custom:</p>
<pre><code>menuentry &quot;GNU/Linux, Linux 5.10.17-lfs-10.1&quot; {
        load_video
        insmod ext2
        set root=(hd0,2)
        linux   /boot/vmlinuz-5.10.17-lfs-10.1 root=/dev/sda4 ro
}
</code></pre><blockquote>
<p>because I use UEFI in VM, GRUB had to get config from /dev/sda2&rsquo;s /boot/grub directory first by:</p>
<p>cp $LFS/boot/grub/grub.cfg /boot/grub/</p>
</blockquote>
<blockquote>
<p>to check UUID:</p>
<pre><code>blkid
</code></pre></blockquote>
<h3 id="build-lfs---the-end">Build LFS - The End<a hidden class="anchor" aria-hidden="true" href="#build-lfs---the-end">#</a></h3>
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter11/theend.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter11/theend.html</a></p>
<pre><code>echo 10.1 &gt; /etc/lfs-release
</code></pre><pre><code>cat &gt; /etc/lsb-release &lt;&lt; &quot;EOF&quot;
DISTRIB_ID=&quot;Linux From Scratch&quot;
DISTRIB_RELEASE=&quot;10.1&quot;
DISTRIB_CODENAME=&quot;&lt;your name here&gt;&quot;
DISTRIB_DESCRIPTION=&quot;Linux From Scratch&quot;
EOF
</code></pre><p>You can customize <code>DISTRIB_ID</code>, <code>DISTRIB_RELEASE</code>,  <code>DISTRIB_CODENAME</code>, and <code>DISTRIB_DESCRIPTION</code> as desire</p>
<blockquote>
<p>for me:</p>
<p>cat &gt; /etc/lsb-release &laquo; &ldquo;EOF&rdquo;
DISTRIB_ID=&quot;Linux From Scratch&rdquo;
DISTRIB_RELEASE=&quot;10.1&rdquo;
DISTRIB_CODENAME=&quot;amirvincent64&rdquo;
DISTRIB_DESCRIPTION=&quot;Linux From Scratch&rdquo;
EOF</p>
</blockquote>
<pre><code>cat &gt; /etc/os-release &lt;&lt; &quot;EOF&quot;
NAME=&quot;Linux From Scratch&quot;
VERSION=&quot;10.1&quot;
ID=lfs
PRETTY_NAME=&quot;Linux From Scratch 10.1&quot;
VERSION_CODENAME=&quot;&lt;your name here&gt;&quot;
EOF
</code></pre><p>You can customize <code>NAME</code>, <code>VERSION</code>, <code>ID</code>, <code>PRETTY_NAME</code>, and <code>VERSION_CODENAME</code> as desire</p>
<blockquote>
<p>for me:</p>
<p>cat &gt; /etc/os-release &laquo; &ldquo;EOF&rdquo;
NAME=&quot;Linux From Scratch&rdquo;
VERSION=&quot;10.1&rdquo;
ID=lfs
PRETTY_NAME=&quot;Linux From Scratch 10.1&rdquo;
VERSION_CODENAME=&quot;amirvincent64&rdquo;
EOF</p>
</blockquote>
<h4 id="get-countedhttpwwwlinuxfromscratchorglfsviewstablechapter11getcountedhtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter11/getcounted.html">Get Counted</a><a hidden class="anchor" aria-hidden="true" href="#get-countedhttpwwwlinuxfromscratchorglfsviewstablechapter11getcountedhtml">#</a></h4>
<h4 id="rebooting-the-systemhttpwwwlinuxfromscratchorglfsviewstablechapter11reboothtml"><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter11/reboot.html">Rebooting the System</a><a hidden class="anchor" aria-hidden="true" href="#rebooting-the-systemhttpwwwlinuxfromscratchorglfsviewstablechapter11reboothtml">#</a></h4>
<h2 id="final">Final<a hidden class="anchor" aria-hidden="true" href="#final">#</a></h2>
<p>although the kernel I built got some panic</p>
<p><img src="https://amirvincent64.github.io/images/VirtualBox_LFS_02.png" alt=""></p>
<p>but after I switch to ubuntu&rsquo;s kernel, it can boot</p>
<p><img src="https://amirvincent64.github.io/images/VirtualBox_LFS_01.png" alt=""></p>
<p>that&rsquo;s it. thanks for reading my notes about LFS 10.1 :-)</p>
<h2 id="ps1-updates">PS1: Updates<a hidden class="anchor" aria-hidden="true" href="#ps1-updates">#</a></h2>
<p>WIP</p>
<h2 id="ps2-install-grub-to-uefihttpwwwlinuxfromscratchorghintsdownloadsfileslfs-uefitxt"><a href="http://www.linuxfromscratch.org/hints/downloads/files/lfs-uefi.txt">PS2: Install GRUB to UEFI</a><a hidden class="anchor" aria-hidden="true" href="#ps2-install-grub-to-uefihttpwwwlinuxfromscratchorghintsdownloadsfileslfs-uefitxt">#</a></h2>
<p>to the machine are in (U)EFI:</p>
<pre><code>ls /sys/firmware/efi
</code></pre><p>in chroot, mount the host&rsquo;s boot partition to /boot/efi:</p>
<pre><code>mkdir -p /boot/efi
mount -vt vfat /dev/sda1 /boot/efi
</code></pre><p>Install the following BLFS packages:</p>
<p><a href="http://www.linuxfromscratch.org/blfs/view/stable/general/libtasn1.html"><code>libtasn1</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/postlfs/p11-kit.html"><code>p11-kit</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/postlfs/make-ca.html"><code>make-ca</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/basicnet/curl.html"><code>curl</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/basicnet/wget.html"><code>wget</code></a>.</p>
<blockquote>
<p>recommend to separate packages location between BLFS and LFS</p>
<p>make BLFS separate sources folder:</p>
<p>in host:</p>
<pre><code>mkdir -p $LFS/sources/BLFS
</code></pre><p>in chroot:</p>
<pre><code>mkdir -p /sources/BLFS
</code></pre></blockquote>
<p>Install the following BLFS packages, using the instructions in the book:
<a href="http://www.linuxfromscratch.org/blfs/view/stable/postlfs/dosfstools.html"><code>dosfstools</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/popt.html"><code>popt</code></a> and <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/pciutils.html"><code>pciutils</code></a>.</p>
<p>Build and install <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/freetype2.html"><code>FreeType</code></a>
if building grub with <code>grub-mkfont</code> enabled.</p>
<p>The BLFS <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/freetype2.html"><code>FreeType</code></a> instructions recommend that it be built after <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/which.html"><code>which</code></a> and <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/libpng.html"><code>libpng</code></a> have been installed.</p>
<blockquote>
<p>so it was, however, as the recommendation for &ldquo;<a href="http://www.linuxfromscratch.org/blfs/view/stable/general/harfbuzz.html">HarfBuzz</a>&rdquo; notes that one builds <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/freetype2.html"><code>FreeType</code></a> without it first, and then do a re-install, it wasn&rsquo;t thought necessary to do the re-install.</p>
<p>for &ldquo;<a href="http://www.linuxfromscratch.org/blfs/view/stable/general/harfbuzz.html">HarfBuzz</a>&rdquo;, install these dependencies:</p>
<p><a href="http://www.linuxfromscratch.org/blfs/view/stable/general/pcre.html"><code>PCRE</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/libxml2.html"><code>libxml2</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/libxslt.html"><code>libxslt</code></a>, <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/glib2.html"><code>GLib</code></a>.</p>
</blockquote>
<p>The <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/libpng.html"><code>libpng</code></a> install did include the &ldquo;apng&rdquo; patch.</p>
<p>then follow descriptions <strong>starting from <code>EFIVAR-37</code> chapter</strong> in the link:</p>
<p><a href="http://www.linuxfromscratch.org/hints/downloads/files/lfs-uefi.txt">http://www.linuxfromscratch.org/hints/downloads/files/lfs-uefi.txt</a></p>
<blockquote>
<p>efivar currrently has a bug about lto-wrapper, to fix this, see:</p>
<p><a href="https://github.com/rhboot/efivar/issues/156">https://github.com/rhboot/efivar/issues/156</a></p>
</blockquote>
<p>Require dependencies starting from <code>EFIVAR-37</code> chapter:</p>
<p><a href="http://www.linuxfromscratch.org/blfs/view/stable/general/popt.html"><code>popt</code></a> and <code>efivar</code>
Optional: <a href="http://www.linuxfromscratch.org/blfs/view/stable/general/freetype2.html"><code>FreeType</code></a> (for <code>grub-mkfont</code> and <code>unicode.pf2</code>) <code>unifont</code> (for <code>unicode.pf2</code>)</p>
<p>(WIP)</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter03/introduction.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter03/introduction.html</a> (LFS 10.1 Stable) <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter04/chapter04.html">http://www.linuxfromscratch.org/lfs/view/stable/chapter04/chapter04.html</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/part3.html">http://www.linuxfromscratch.org/lfs/view/stable/part3.html</a> <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>refer: <a href="http://www.linuxfromscratch.org/lfs/view/stable/part4.html">http://www.linuxfromscratch.org/lfs/view/stable/part4.html</a> <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://amirvincent64.github.io/en/tags/lfs/">LFS</a></li>
    </ul>
    <nav class="paginav">
      <a class="next" href="https://amirvincent64.github.io/en/posts/2021-02-07-wow-gentoo/">
        <span class="title">Next Page »</span>
        <br>
        <span>WOW! Gentoo!</span>
      </a>
    </nav>






<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on twitter"
        href="https://twitter.com/intent/tweet/?text=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d&amp;url=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f&amp;hashtags=LFS">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f&amp;title=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d&amp;summary=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d&amp;source=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f&title=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on whatsapp"
        href="https://api.whatsapp.com/send?text=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d%20-%20https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Linux From Scratch 10.1 Notes [Alpha] on telegram"
        href="https://telegram.me/share/url?text=Linux%20From%20Scratch%2010.1%20Notes%20%5bAlpha%5d&amp;url=https%3a%2f%2famirvincent64.github.io%2fen%2fposts%2fnotes-10.1-linux-from-scratch%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>


<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'amirvincent64blog';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://amirvincent64.github.io/en/">amir.</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script defer src="https://amirvincent64.github.io/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
